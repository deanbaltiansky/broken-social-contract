---
title: "Broken Social Contract"
subtitle: "Study 1: Analysis Report"
Author: "Dean Baltiansky"
output:
  html_document:
    toc: true
    toc_float: true
    code_folding: hide
knit: (function(input_file, encoding) { rmarkdown::render(input_file, encoding = encoding, output_file = 'index.html', output_dir = here::here('docs','studies','study-1')); })
---

```{r,include=FALSE}
detachAllPackages <- function() {

  basic.packages <- c("package:stats","package:graphics","package:grDevices","package:utils","package:datasets","package:methods","package:base")

  package.list <- search()[ifelse(unlist(gregexpr("package:",search()))==1,TRUE,FALSE)]

  package.list <- setdiff(package.list,basic.packages)

  if (length(package.list)>0)  for (package in package.list) detach(package, character.only=TRUE)

}

detachAllPackages()
```

```{r,include=FALSE}
library(apa)
library(see)
library(lme4)
library(lmerTest)
library(interactions)
library(jtools)
library(gridExtra)
library(kableExtra)
library(apaTables)
library(papaja)
library(knitr)
library(psych)
library(GPArotation)
library(PerformanceAnalytics)
library(gt)
library(tidytext)
library(textdata)
library(tidyverse)
library(diagram)
library(factoextra)
library(SnowballC)
library(hunspell)
library(quanteda)

repo_url <- "https://raw.githubusercontent.com/deanbaltiansky/broken-social-contract/main/study-1/data/"

df_bsc <- readr::read_csv(paste0(repo_url,"df_bsc.csv"), show_col_types = FALSE)
df_bsc_long <- readr::read_csv(paste0(repo_url,"df_bsc_long.csv"), show_col_types = FALSE)
```

```{r,include=FALSE}
df_bsc <- df_bsc %>% 
  mutate(income = factor(income,c("$0-$20,000",
                                  "$20,001-$40,000",
                                  "$40,001-$60,000",
                                  "$60,001-$80,000",
                                  "$80,001-$100,000",
                                  "$100,001-$120,000",
                                  "$120,001-$140,000",
                                  "$140,001-$160,000",
                                  "$160,001-$180,000",
                                  "$180,001-$200,000",
                                  "Over $200,000")),
         edu = factor(edu,c("noHS",
                            "GED",
                            "2yearColl",
                            "4yearColl",
                            "MA",
                            "PHD")),
         county_gini = as.numeric(county_gini),
         county_density = as.numeric(county_density),
         county_medianincome = as.numeric(county_medianincome))

df_bsc_elg <- df_bsc %>% 
  filter(is_elg == 1)

elg_PIDs <- df_bsc_elg %>% 
  select(PID) %>% 
  unlist() %>% 
  unname()

df_bsc_long_elg <- df_bsc_long %>% 
  filter(PID %in% elg_PIDs)
```

# Background

This is a preregistered nationally representative study. See preregistration <a href="https://osf.io/gtv5n/?view_only=4466b8cdb0664fb7892aa79506fce2b3" target="_blank">here</a>.\
\
This is joint work with Prof. <a href="https://sandramatz.com/" target="_blank">Sandra Matz</a>, led by me as the Principal Investigator.

## Description

In this project, we examine the role of the psychological experience of a broken social contract in peopleâ€™s trust in institutions and anti-establishment sentiment. To measure this, we identify gaps between what people believe they are promised by the state on paper (i.e., the constitution) and what they are being provided by the government in practice. Controlling for a wide range of potential confounds, we then examine the explanatory role this gap plays in various socio-political behavioral and attitudinal outcomes; broadly defined as **political discontent**.

## Hypotheses

1. The psychological experience of a broken social contract is negatively associated with the likelihood of voting in the 2024 Presidential Election.\
2. The psychological experience of a broken social contract is positively associated with support for radical change.\
3. The psychological experience of a broken social contract is positively associated with anti-establishment sentiment.\
4. The psychological experience of a broken social contract is negatively associated with trust in democratic governmental institutions (the executive, legislative, and judicial branches of government).\
5. The psychological experience of a broken social contract is negatively associated with trust in mainstream non-political institutions (media, education, police, military, finance, medicine).

## Study design

Two major parts:\
1. **Broken Social Contract:** Participants listed what they believe are the top five guiding values for the US on paper and what they believe are the top five guiding values for the US in practice. For each of these perspectives, they assigned weights to each value based on its perceived importance to the US on paper and in practice, respectively.\
2. **Attitudes and individual differences:** Participants completed measures of anti-establishment sentiment, trust in institutions, support for radical change, voting intentions, Social Dominance Orientation (SDO), big five personality traits (i.e., openness, conscientiousness, extroversion, agreeableness, and neuroticism), political ideology and identification, and demographic information.

## Computational analytic strategy

We retrieved embeddings for each of the open-response guiding values inputted by participants, five for the US on paper and five for the US in practice. The embeddings were retrieved from OpenAI's API, using the <a href="https://platform.openai.com/docs/models/text-embedding-3-large" target="_blank">text-embedding-3-large</a> model. This gave us a 3,072-dimensional vector representing the phrase's meaning in a large multi-dimensional semantic space.\
\
Using participant-assigned weights, we then created weighted means for each perspective (US on paper and US in practice). This resulted in two 3,072-dimensional vectors, representing America's promise and America's policies in practice, as perceived by a single participant.\
\
To compare the two vectors, we calculated their cosine similarity. So, higher scores mean that America's policies resemble its promise, whereas lower scores mean that its policies do NOT resemble its promise.\
\
Finally, to arrive at a *broken social contract* score, we reverse-score the cosine similarity by subtracting it from 1.

## Analysis plan

The following linear models will be conducted for each of these outcome variables: (1) Likelihood to vote in the 2024 Presidential election; (2) support for radical change; (3) anti-establishment sentiment; (4) trust in democratic institutions; (5) trust in mainstream societal institutions.\
\
1. Linear Model 1: Broken contract score as predictor; conservatism as control.\
2. Linear Model 2: Broken contract score as predictor; conservatism, SDO, and agreeableness as controls.\
3. Linear Model 3: Broken contract score as predictor; conservatism, SDO, agreeableness, gender, race, ethnicity, income, education, and age as controls.\
4. Linear Model 4: Broken contract score as predictor; conservatism, SDO, agreeableness, gender, race, ethnicity, income, education, age, county mediation income, county GINI coefficient, and county density as controls.

# Data collection

We collected data on 3/27/2024-3/28/2024 through Connect by CloudResearch; an online participant recruitment platform. The sample was intended to be representative of the U.S. population in March 2024 along the lines of gender (~50.4% women ~49.6% men), race (~58.9% non-Hispanic White, ~18.2% Hispanic or Latino, ~13.6% Black, ~6.3% Asian, and ~3% more than one race or other), age (~20.1% 18-29 years, ~25.9% 30-44 years, ~23.3% 45-59 years, and ~30.7% 60-99 years), and political party affiliation (41% Independents, 30% Republicans, and 28% Democrats). The target sample was set at 1,200 participants.\
\
We excluded participants who failed attention checks: one simple attention check embedded in the anti-establishment scale and another with incoherent open-text. Let's see how many eligible participants we end up with:

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
n_eligible <- df_bsc %>% 
  group_by(is_elg) %>% 
  summarise(N = n()) %>% 
  ungroup() %>% 
  filter(is_elg == 1) %>% 
  select(N) %>% 
  unlist() %>% 
  unname()

df_bsc %>% 
  group_by(is_elg) %>% 
  summarise(N = n()) %>% 
  ungroup() %>% 
  mutate(Perc = round(100*(N/sum(N)),2)) %>% 
  ungroup() %>% 
  kbl() %>% 
  kable_styling(bootstrap_options = "hover",
                full_width = F,
                position = "left")
```

Great. That leaves us with `r n_eligible` eligible participants.

# Demographics

## Race and ethnicity

```{r,results='asis',echo=TRUE,warning=FALSE}
df_bsc_elg %>% 
  mutate(race = ifelse(is.na(race),"Other (please specify)",race)) %>% 
  mutate(ethnicity = ifelse(is.na(hispanic),"Non-Hisapnic",
                            ifelse(hispanic == 1,"Hispanic","Non-Hispanic"))) %>% 
  group_by(race,ethnicity) %>% 
  summarise(N = n()) %>% 
  ungroup() %>% 
  mutate(Perc = round(100*(N/sum(N)),2)) %>% 
  ungroup() %>% 
  arrange(desc(Perc)) %>% 
  kbl() %>% 
  kable_styling(bootstrap_options = "hover",
                full_width = F,
                position = "left")
```

## Gender

```{r,echo=TRUE,results='asis',warning=FALSE}
df_bsc_elg %>% 
  mutate(gender = ifelse(is.na(gender) | gender == "","other",gender)) %>% 
  group_by(gender) %>% 
  summarise(N = n()) %>% 
  ungroup() %>% 
  mutate(Perc = round(100*(N/sum(N)),2)) %>% 
  ungroup() %>% 
  arrange(desc(Perc)) %>% 
  kbl() %>% 
  kable_styling(bootstrap_options = "hover",
                full_width = F,
                position = "left")
```

## Age

```{r,echo=TRUE,results='asis',warning=FALSE}
df_bsc_elg %>% 
  summarise(age_mean = round(mean(age,na.rm = T),2),
            age_sd = round(sd(age,na.rm = T),2)) %>% 
  kbl() %>% 
  kable_styling(bootstrap_options = "hover",
                full_width = F,
                position = "left")
```

## Education

```{r,echo=TRUE,results='asis',warning=FALSE}
df_bsc_elg %>% 
  group_by(edu) %>% 
  summarise(N = n()) %>% 
  ungroup() %>% 
  mutate(Perc = round(100*(N/sum(N)),2)) %>% 
  ungroup() %>% 
  kbl() %>% 
  kable_styling(bootstrap_options = "hover",
                full_width = F,
                position = "left")
```

## Income

```{r,fig.align='left',echo=TRUE,warning=FALSE,fig.dim=c(5,3)}
df_bsc_elg %>% 
  ggplot(aes(x = income)) +
  geom_bar() +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.background = element_blank(),
        axis.ticks = element_blank(),
        axis.line = element_line(color = "grey66"),
        axis.text.y = element_text(color = "black"),
        axis.text.x = element_text(color = "black",
                                   face = "bold"),
        axis.title.x = element_blank(),
        axis.title.y = element_blank()) +
  coord_flip()


```

## County inequallity

County GINI coefficient was taken from the US Census Website.

```{r,fig.align='left',echo=TRUE,warning=FALSE,fig.dim=c(4,3)}
df_bsc_elg %>% 
  filter(!is.na(county_gini)) %>% 
  ggplot(aes(x = county_gini)) +
  geom_histogram(fill = "lightblue",
                 binwidth = 0.005) +
  #scale_x_continuous(breaks = seq(0,1,0.1)) +
  ylab("count") +
  geom_vline(xintercept = mean(df_bsc_elg$county_gini,na.rm = T),
             color = "black",
             linetype = "dashed",
             size = 1.1) +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.background = element_blank(),
        axis.ticks = element_blank(),
        axis.line = element_line(color = "grey66"),
        axis.text.y = element_text(color = "black"),
        axis.text.x = element_text(color = "black",
                                   face = "bold"),
        axis.title.x = element_text(color = "black",
                                   face = "bold"))
```

## County median income

County median income was taken from the US Census Website.

```{r,fig.align='left',echo=TRUE,warning=FALSE,fig.dim=c(4,3)}
df_bsc_elg %>% 
  filter(!is.na(county_medianincome)) %>% 
  ggplot(aes(x = county_medianincome)) +
  geom_histogram(fill = "lightblue",
                 binwidth = 5000) +
  #scale_x_continuous(breaks = seq(0,1,0.1)) +
  ylab("count") +
  geom_vline(xintercept = mean(df_bsc_elg$county_medianincome,na.rm = T),
             color = "black",
             linetype = "dashed",
             size = 1.1) +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.background = element_blank(),
        axis.ticks = element_blank(),
        axis.line = element_line(color = "grey66"),
        axis.text.y = element_text(color = "black"),
        axis.text.x = element_text(color = "black",
                                   face = "bold"),
        axis.title.x = element_text(color = "black",
                                   face = "bold"))
```

## County density

County density was taken from the US Census Website.

```{r,fig.align='left',echo=TRUE,warning=FALSE,fig.dim=c(4,3)}
df_bsc_elg %>% 
  filter(!is.na(county_density)) %>% 
  ggplot(aes(x = county_density)) +
  geom_histogram(fill = "lightblue",
                 binwidth = 500) +
  #scale_x_continuous(breaks = seq(0,1,0.1)) +
  ylab("count") +
  geom_vline(xintercept = mean(df_bsc_elg$county_density,na.rm = T),
             color = "black",
             linetype = "dashed",
             size = 1.1) +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.background = element_blank(),
        axis.ticks = element_blank(),
        axis.line = element_line(color = "grey66"),
        axis.text.y = element_text(color = "black"),
        axis.text.x = element_text(color = "black",
                                   face = "bold"),
        axis.title.x = element_text(color = "black",
                                   face = "bold"))
```

# Politics

## Ideology

Participants were asked about the extent to which they subscribe to the following ideologies on a scale of 1-7 (select NA if unfamiliar): Conservatism, Liberalism, Democratic Socialism, Libertarianism, Progressivism.

```{r,fig.align='left',echo=TRUE,warning=FALSE,fig.dim=c(7,5)}
means <- df_bsc_elg %>%
  dplyr::select(PID,ideo_con:ideo_prog) %>% 
  pivot_longer(-PID,
               names_to = "ideo",
               values_to = "score") %>% 
  filter(!is.na(score)) %>% 
  group_by(ideo) %>% 
  summarise(score = mean(score)) %>% 
  ungroup()

df_bsc_elg %>%
  dplyr::select(PID,ideo_con:ideo_prog) %>% 
  pivot_longer(-PID,
               names_to = "ideo",
               values_to = "score") %>% 
  filter(!is.na(score)) %>%  
  ggplot() +
  geom_density(aes(x = score), fill = "lightblue") +
  scale_x_continuous(limits = c(1,7),
                     breaks = seq(1,7,1)) +
  geom_vline(data = means,mapping = aes(xintercept = score),
             color = "black",
             linetype = "dashed",
             size = 1.1) +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.background = element_blank(),
        axis.ticks = element_blank(),
        axis.line = element_line(color = "grey66"),
        axis.text.y = element_text(color = "black"),
        axis.text.x = element_text(color = "black",
                                   face = "bold")) +
  facet_wrap(~ideo,nrow = 2)

```

## Party ID

```{r,echo=TRUE,results='asis',warning=FALSE}
df_bsc_elg %>% 
  group_by(party_id) %>% 
  summarise(N = n()) %>% 
  ungroup() %>% 
  mutate(Perc = round(100*(N/sum(N)),2)) %>% 
  ungroup() %>% 
  kbl() %>% 
  kable_styling(bootstrap_options = "hover",
                full_width = F,
                position = "left")
```

## Vote in 2020

```{r,echo=TRUE,results='asis',warning=FALSE}
df_bsc_elg %>% 
  group_by(vote_2020) %>% 
  summarise(N = n()) %>% 
  ungroup() %>% 
  mutate(Perc = round(100*(N/sum(N)),2)) %>% 
  ungroup() %>% 
  arrange(desc(N)) %>% 
  kbl() %>% 
  kable_styling(bootstrap_options = "hover",
                full_width = F,
                position = "left")
```

## Vote in 2024

```{r,echo=TRUE,results='asis',warning=FALSE}
df_bsc_elg %>% 
  group_by(vote_2024) %>% 
  summarise(N = n()) %>% 
  ungroup() %>% 
  mutate(Perc = round(100*(N/sum(N)),2)) %>% 
  ungroup() %>% 
  arrange(desc(N)) %>% 
  kbl() %>% 
  kable_styling(bootstrap_options = "hover",
                full_width = F,
                position = "left")
```


# Social Contract Measure

## Values: US on paper

Since its independence and onwards, the formation of the United States as a sovereign country was based on a number of values, all of which were inscribed in the constitution. This document, importantly, has evolved since it was first written.\
\
**ON PAPER, what do you think are the values that the U.S. stands for? Please list FIVE values.**\
\
Each value should consist of 1-3 words. Try to be as clear and succinct as possible.\
\
*paste disabled\
\
*below are values mentioned, ordered by the number of mentions*

```{r,echo=TRUE,results='asis',warning=FALSE}
df_bsc_long_elg %>% 
  filter(type == "uspaper") %>% 
  group_by(value) %>%
  summarise(N = n()) %>% 
  ungroup() %>% 
  mutate(Perc = round(100*(N/sum(N)),2)) %>% 
  ungroup() %>% 
  arrange(desc(N)) %>% 
  kbl() %>% 
  kable_styling(bootstrap_options = "hover",
                position = "left") %>% 
  scroll_box(width = "100%", height = "400px")
```

## Weights: US on paper

*participants were shown the values that they inputted in the previous question and were asked to assign them a forced sum of 100 points, based on its perceived importance to the US on paper.*\
\
The values you listed are shown below.\
\
Now, we ask you to indicate how important you think each value is to the U.S. on paper.\
\
To that end, you have a sum of 100 points. Please allocate those points to the values you listed based on how important you think they are to the U.S. ON PAPER.\
\
For example, if you think all five values are equally important, each of them would get 20 points. If you think value X is more important than value Y, then value X would get more points than value Y.

## Values: US in practice

We want you to think of the values that the United States stands for in practice.\
\
Regardless of what is written in the constitution and across party lines, the U.S. administrations stand for certain values and do not stand for others.\
\
**IN PRACTICE, what do you believe are the values that the U.S. stands for? Please list FIVE values.**\
\
Each value should consist of 1-3 words. Try to be as clear and succinct as possible.\
\
*paste disabled\
\
*below are values mentioned, ordered by the number of mentions*

```{r,echo=TRUE,results='asis',warning=FALSE}
df_bsc_long_elg %>% 
  filter(type == "uspractice") %>% 
  group_by(value) %>%
  summarise(N = n()) %>% 
  ungroup() %>% 
  mutate(Perc = round(100*(N/sum(N)),2)) %>% 
  ungroup() %>% 
  arrange(desc(N)) %>% 
  kbl() %>% 
  kable_styling(bootstrap_options = "hover",
                position = "left") %>% 
  scroll_box(width = "100%", height = "400px")
```

## Weights: US in practice

*participants were shown the values that they inputted in the previous question and were asked to assign them a forced sum of 100 points, based on its perceived importance to the US in practice.*\
\
The values you listed are shown below.\
\
Now, we ask you to indicate how important you think each value is to the U.S. in practice.\
\
To that end, you have a sum of 100 points. Please allocate those points to the values you listed based on how important you think they are to the U.S. IN PRACTICE.\
\
For example, if you think all five values are equally important, each of them would get 20 points. If you think value X is more important than value Y, then value X would get more points than value Y.

## Computed Broken Social Contract Variable

See *Computational analytical strategy* above. This is the distribution:

```{r,fig.align='left',echo=TRUE,warning=FALSE,fig.dim=c(4,3)}
df_bsc_elg %>% 
  ggplot(aes(x = brokencontract_openai)) +
  geom_histogram(fill = "lightblue",
                 binwidth = 0.01) +
  scale_x_continuous(breaks = seq(0,1,0.1),
                     limits = c(-0.01,1.01)) +
  ylab("count") +
  geom_vline(xintercept = mean(df_bsc_elg$brokencontract_openai,na.rm = T),
             color = "black",
             linetype = "dashed",
             size = 1.1) +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.background = element_blank(),
        axis.ticks = element_blank(),
        axis.line = element_line(color = "grey66"),
        axis.text.y = element_text(color = "black"),
        axis.text.x = element_text(color = "black",
                                   face = "bold"),
        axis.title.x = element_text(color = "black",
                                   face = "bold"))
```

# Political Discontent Measures

## Anti-establishment sentiment

```{r,include=F}
alpha_table <- df_bsc_elg %>% 
  dplyr::select(antiest_1,
                antiest_2,
                antiest_3,
                antiest_4R) %>% 
  psych::alpha()

alpha <- alpha_table$total[1]
```

1. The USâ€™s economy is rigged to advantage the rich and powerful\
2. Traditional politicians and parties donâ€™t care about people like me\
3. Experts in this country donâ€™t understand the lives of people like me\
4. Most of the time we can trust people in the government to do what is right [R]
\
Cronbach's alpha = `r round(alpha,2)`

```{r,fig.align='left',echo=TRUE,warning=FALSE,fig.dim=c(5,3)}
df_bsc_elg %>% 
  ggplot(aes(x = antiest)) +
  geom_density(fill = "lightblue",
                 color = NA) +
  scale_x_continuous(breaks = seq(1,7,1),
                     limits = c(1,7)) +
  ylab("density") +
  geom_vline(xintercept = mean(df_bsc_elg$antiest,na.rm = T),
             color = "black",
             linetype = "dashed",
             size = 1.1) +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.background = element_blank(),
        axis.ticks = element_blank(),
        axis.line = element_line(color = "grey66"),
        axis.text.y = element_text(color = "black"),
        axis.text.x = element_text(color = "black",
                                   face = "bold"),
        axis.title.x = element_text(color = "black",
                                   face = "bold"))
```

## Support for radical change

To what extent do you agree with the following statement?\
\
*The way this country works needs to be radically changed*

```{r,fig.align='left',echo=TRUE,warning=FALSE,fig.dim=c(5,3)}
df_bsc_elg %>% 
  ggplot(aes(x = change)) +
  geom_histogram(fill = "lightblue",
                 binwidth = 1) +
  scale_x_continuous(breaks = seq(1,7,1),
                     limits = c(0,8)) +
  ylab("count") +
  geom_vline(xintercept = mean(df_bsc_elg$change,na.rm = T),
             color = "black",
             linetype = "dashed",
             size = 1.1) +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.background = element_blank(),
        axis.ticks = element_blank(),
        axis.line = element_line(color = "grey66"),
        axis.text.y = element_text(color = "black"),
        axis.text.x = element_text(color = "black",
                                   face = "bold"),
        axis.title.x = element_text(color = "black",
                                   face = "bold"))
```

## Trust in democratic political instituions


```{r,include=F}
alpha_table <- df_bsc_elg %>% 
  dplyr::select(trust_congress:trust_courts) %>% 
  psych::alpha()

alpha <- alpha_table$total[1]
```

Please indicate how much you trust or distrust the following institutions (1 = *Strongly Distrust* to 7 = *Strongly Trust*)\
\
1. The US Congress / Legislative Branch\
2. The US Government / Executive Branch\
3. The US Courts / Judicial Branch\
\
Cronbach's alpha = `r round(alpha,2)`

```{r,fig.align='left',echo=TRUE,warning=FALSE,fig.dim=c(5,3)}
df_bsc_elg %>% 
  ggplot(aes(x = trust_deminst)) +
  geom_density(fill = "lightblue",
               color = NA) +
  scale_x_continuous(breaks = seq(1,7,1),
                     limits = c(1,7)) +
  ylab("density") +
  geom_vline(xintercept = mean(df_bsc_elg$trust_deminst,na.rm = T),
             color = "black",
             linetype = "dashed",
             size = 1.1) +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.background = element_blank(),
        axis.ticks = element_blank(),
        axis.line = element_line(color = "grey66"),
        axis.text.y = element_text(color = "black"),
        axis.text.x = element_text(color = "black",
                                   face = "bold"),
        axis.title.x = element_text(color = "black",
                                   face = "bold"))
```

## Trust in non-political mainstream institutions

```{r,include=F}
alpha_table <- df_bsc_elg %>% 
  dplyr::select(trust_media,
                trust_edu,
                trust_police,
                trust_millitary,
                trust_finance,
                trust_med) %>% 
  psych::alpha()

alpha <- alpha_table$total[1]
```

Please indicate how much you trust or distrust the following institutions (1 = *Strongly Distrust* to 7 = *Strongly Trust*)\
\
1. Mainstream media in the US (e.g., CNN, FOX News, MSNBC, New York Times, Wall-Street Journal, USA Today) \
2. The education system in the US\
3. Law enforcement / police in the US\
4. The US Military\
5. Financial institutions in the US (e.g., Wall Street, The Fed, The Big Banks)\
6. The medical system in the US\
\
Cronbach's alpha = `r round(alpha,2)`

```{r,fig.align='left',echo=TRUE,warning=FALSE,fig.dim=c(5,3)}
df_bsc_elg %>% 
  ggplot(aes(x = trust_natinst)) +
  geom_density(fill = "lightblue",
                 color = NA) +
  scale_x_continuous(breaks = seq(1,7,1),
                     limits = c(1,7)) +
  ylab("density") +
  geom_vline(xintercept = mean(df_bsc_elg$trust_natinst,na.rm = T),
             color = "black",
             linetype = "dashed",
             size = 1.1) +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.background = element_blank(),
        axis.ticks = element_blank(),
        axis.line = element_line(color = "grey66"),
        axis.text.y = element_text(color = "black"),
        axis.text.x = element_text(color = "black",
                                   face = "bold"),
        axis.title.x = element_text(color = "black",
                                   face = "bold"))
```

## Trust in science

```{r,include=F}
alpha_table <- df_bsc_elg %>% 
  dplyr::select(trust_science_1,
                trust_science_2,
                trust_science_3) %>% 
  psych::alpha()

alpha <- alpha_table$total[1]
```

Please indicate how much you agree or disagree with the following statements (1 = *Strongly Disagree* to 7 = *Strongly Agree*)\
\
1. I generally trust the recommendations of scientists\
2. Scientific institutions generate objective knowledge\
3. I look to the social sciences for answers to social problems\
\
Cronbach's alpha = `r round(alpha,2)`

```{r,fig.align='left',echo=TRUE,warning=FALSE,fig.dim=c(5,3)}
df_bsc_elg %>% 
  ggplot(aes(x = trust_science)) +
  geom_density(fill = "lightblue",
                 color = NA) +
  scale_x_continuous(breaks = seq(1,7,1),
                     limits = c(1,7)) +
  ylab("density") +
  geom_vline(xintercept = mean(df_bsc_elg$trust_science,na.rm = T),
             color = "black",
             linetype = "dashed",
             size = 1.1) +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.background = element_blank(),
        axis.ticks = element_blank(),
        axis.line = element_line(color = "grey66"),
        axis.text.y = element_text(color = "black"),
        axis.text.x = element_text(color = "black",
                                   face = "bold"),
        axis.title.x = element_text(color = "black",
                                   face = "bold"))
```

## Turnout for Presidential Election

What is the likelihood that you will vote in the 2024 Presidential Elections?
1 = *Not at All Likely* to 5 = *Extremely Likely*

```{r,fig.align='left',echo=TRUE,warning=FALSE,fig.dim=c(5,3)}
df_bsc_elg %>% 
  ggplot(aes(x = vote_likely)) +
  geom_histogram(fill = "lightblue",
                 binwidth = 1) +
  scale_x_continuous(breaks = seq(1,5,1),
                     limits = c(0,6)) +
  ylab("count") +
  geom_vline(xintercept = mean(df_bsc_elg$vote_likely,na.rm = T),
             color = "black",
             linetype = "dashed",
             size = 1.1) +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.background = element_blank(),
        axis.ticks = element_blank(),
        axis.line = element_line(color = "grey66"),
        axis.text.y = element_text(color = "black"),
        axis.text.x = element_text(color = "black",
                                   face = "bold"),
        axis.title.x = element_text(color = "black",
                                   face = "bold"))
```

# Control variables

## Social Dominance Orientation

```{r,include=F}
alpha_table <- df_bsc_elg %>% 
  dplyr::select(SDO_1:SDO_8R) %>% 
  psych::alpha()

alpha <- alpha_table$total[1]
```

1. An ideal society requires some groups to be on top and others to be on the bottom\
2. Some groups of people are simply inferior to other groups\
3. No one group should dominate in society [R]\
4. Groups at the bottom are just as deserving as groups at the top [R]\
5. Group equality should not be our primary goal\
6. It is unjust to try to make groups equal\
7. We should do what we can to equalize conditions for different groups [R]\
8. We should work to give all groups an equal chance to succeed [R]\
\
Cronbach's alpha = `r round(alpha,2)`

```{r,fig.align='left',echo=TRUE,warning=FALSE,fig.dim=c(5,3)}
df_bsc_elg %>% 
  ggplot(aes(x = SDO)) +
  geom_density(fill = "lightblue",
                 color = NA) +
  scale_x_continuous(breaks = seq(1,7,1),
                     limits = c(1,7)) +
  ylab("density") +
  geom_vline(xintercept = mean(df_bsc_elg$SDO,na.rm = T),
             color = "grey15",
             size = 1,
             linetype = "dashed") +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.background = element_blank(),
        axis.ticks = element_blank(),
        axis.line = element_line(color = "grey66"),
        axis.text.y = element_text(color = "black"),
        axis.text.x = element_text(color = "black",
                                   face = "bold"),
        axis.title.x = element_text(color = "black",
                                   face = "bold"))
```

## Ten-Iten Personality Inventory

I see myself as... (1 = *Strongly Disagree* to 7 = *Strongly Agree*)

1. Extraverted, enthusiastic\
2. Critical, quarrelsome [R]\
3. Dependable, self-disciplined\
4. Anxious, easily upset\
5. Open to new experiences, complex\
6. Reserved, quiet [R]\
7. Sympathetic, warm\
8. Disorganized, careless [R]\
9. Calm, emotionally stable [R]\
10. Conventional, uncreative [R]\
\
**Extraversion:** Mean score of items 1 and 6\
**Agreeableness:** Mean score of items 2 and 7\
**Conscientiousness:** Mean score of items 3 and 8\
**Neuroticism:** Mean score of items 4 and 9\
**Openness:** Mean score of items 5 and 10


```{r,fig.align='left',echo=TRUE,warning=FALSE,fig.dim=c(7,5)}
means <- df_bsc_elg %>%
  dplyr::select(PID,TIPI_extra:TIPI_open) %>% 
  pivot_longer(-PID,
               names_to = "trait",
               values_to = "score") %>% 
  filter(!is.na(score)) %>% 
  group_by(trait) %>% 
  summarise(score = mean(score)) %>% 
  ungroup()

df_bsc_elg %>%
  dplyr::select(PID,TIPI_extra:TIPI_open) %>% 
  pivot_longer(-PID,
               names_to = "trait",
               values_to = "score") %>% 
  filter(!is.na(score)) %>%  
  ggplot() +
  geom_density(aes(x = score), fill = "lightblue") +
  scale_x_continuous(limits = c(1,7),
                     breaks = seq(1,7,1)) +
  geom_vline(data = means,mapping = aes(xintercept = score),
             color = "black",
             linetype = "dashed",
             size = 1.1) +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.background = element_blank(),
        axis.ticks = element_blank(),
        axis.line = element_line(color = "grey66"),
        axis.text.y = element_text(color = "black"),
        axis.text.x = element_text(color = "black",
                                   face = "bold")) +
  facet_wrap(~trait,nrow = 2)

```

# Analysis

## Correlation matrix

Explore further correlations here: [Shiny App].

```{r,fig.align='left',echo=TRUE,warning=FALSE,message=FALSE,fig.dim=c(9,9)}
df_bsc_elg %>% 
  rename(brokencontract = brokencontract_openai) %>% 
  dplyr::select(brokencontract,antiest,change,trust_deminst,trust_natinst,trust_science,vote_likely,
                SDO,ideo_con:ideo_prog,TIPI_extra:TIPI_open) %>%
  corPlot(upper = TRUE,stars = TRUE,xsrt = 270)

df_bsc_elg %>% 
  select(brokencontract_openai,antiest:trust_science,vote_likely:change,SDO:TIPI_open,vote_likely:change,ideo_con:ideo_prog,
         republican:independent,
         vote_2024_trump:vote_2024_other,
         man,white,age,income_num,edu_num,
         county_gini:county_medianincome) %>% 
  variable.names() %>% 
  write.csv("~/Google Drive/My Drive/american's dream/for github/broken-social-contract/study-1/data/var_info.csv",row.names = F)
```

```{r,include=FALSE}
df_bsc_elg <- df_bsc_elg %>% 
  mutate(simi_z = scale(simi),
         simi_openai_z = scale(simi_openai),
         brokencontract_glove_z = scale(brokencontract_glove),
         brokencontract_openai_z = scale(brokencontract_openai),
         vote_likely_z = scale(vote_likely),
         change_z = scale(change),
         antiest_z = scale(antiest),
         trust_deminst_z = scale(trust_deminst),
         trust_natinst_z = scale(trust_natinst),
         trust_science_z = scale(trust_science),
         ideo_con_z = scale(ideo_con),
         ideo_lib_z = scale(ideo_lib),
         ideo_demsoc_z = scale(ideo_demsoc),
         ideo_lbrtn_z = scale(ideo_lbrtn),
         ideo_prog_z = scale(ideo_prog),
         SDO_z = scale(SDO),
         TIPI_agree_z = scale(TIPI_agree),
         income_num_z = scale(income_num),
         edu_num_z = scale(edu_num),
         age_z = scale(age),
         county_density_z = scale(as.numeric(county_density)),
         county_gini_z = scale(as.numeric(county_gini)),
         county_medianincome_z = scale(as.numeric(county_medianincome)))
```


## Outcome Variable: Likelihood to vote in the 2024 Presidential election

### Model 1

Similarity score as predictor; conservatism as control.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(vote_likely_z ~ simi_z + ideo_con_z ,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)

```

### Model 2

Similarity score as predictor; conservatism, SDO, and TIPI agreeableness as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(vote_likely_z ~ simi_z + ideo_con_z + SDO_z + TIPI_agree_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)

```

### Model 3

Similarity score as predictor; conservatism, SDO, TIPI agreeableness, gender, race, ethnicity, income, education, and age as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(vote_likely_z ~ simi_z + ideo_con_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)

```

### Model 4

Similarity score as predictor; conservatism, SDO, TIPI agreeableness, gender, race, ethnicity, income, education, age, county mediation income, county GINI coefficient, and county density as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(vote_likely_z ~ simi_z + ideo_con_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z + county_medianincome_z + county_gini_z + county_density_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)

```

## Outcome Variable: Support for radical change

### Model 1

Similarity score as predictor; conservatism as control.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(change_z ~ simi_z + ideo_con_z ,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

### Model 2

Similarity score as predictor; conservatism, SDO, and TIPI agreeableness as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(change_z ~ simi_z + ideo_con_z + SDO_z + TIPI_agree_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

### Model 3

Similarity score as predictor; conservatism, SDO, TIPI agreeableness, gender, race, ethnicity, income, education, and age as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(change_z ~ simi_z + ideo_con_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)

```

### Model 4

Similarity score as predictor; conservatism, SDO, TIPI agreeableness, gender, race, ethnicity, income, education, age, county mediation income, county GINI coefficient, and county density as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(change_z ~ simi_z + ideo_con_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z + county_medianincome_z + county_gini_z + county_density_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

## Outcome Variable: Anti-establishment sentiment

### Model 1

Similarity score as predictor; conservatism as control.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(antiest_z ~ simi_z + ideo_con_z ,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

### Model 2

Similarity score as predictor; conservatism, SDO, and TIPI agreeableness as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(antiest_z ~ simi_z + ideo_con_z + SDO_z + TIPI_agree_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

### Model 3

Similarity score as predictor; conservatism, SDO, TIPI agreeableness, gender, race, ethnicity, income, education, and age as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(antiest_z ~ simi_z + ideo_con_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)

```

### Model 4

Similarity score as predictor; conservatism, SDO, TIPI agreeableness, gender, race, ethnicity, income, education, age, county mediation income, county GINI coefficient, and county density as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(antiest_z ~ simi_z + ideo_con_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z + county_medianincome_z + county_gini_z + county_density_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

## Outcome Variable: Trust in democratic institutions

### Model 1

Similarity score as predictor; conservatism as control.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(trust_deminst_z ~ simi_z + ideo_con_z ,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

### Model 2

Similarity score as predictor; conservatism, SDO, and TIPI agreeableness as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(trust_deminst_z ~ simi_z + ideo_con_z + SDO_z + TIPI_agree_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

### Model 3

Similarity score as predictor; conservatism, SDO, TIPI agreeableness, gender, race, ethnicity, income, education, and age as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(trust_deminst_z ~ simi_z + ideo_con_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)

```

### Model 4

Similarity score as predictor; conservatism, SDO, TIPI agreeableness, gender, race, ethnicity, income, education, age, county mediation income, county GINI coefficient, and county density as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(trust_deminst_z ~ simi_z + ideo_con_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z + county_medianincome_z + county_gini_z + county_density_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

## Outcome Variable: Trust in national mainstream institutions

### Model 1

Similarity score as predictor; conservatism as control.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(trust_natinst_z ~ simi_z + ideo_con_z ,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

### Model 2

Similarity score as predictor; conservatism, SDO, and TIPI agreeableness as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(trust_natinst_z ~ simi_z + ideo_con_z + SDO_z + TIPI_agree_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

### Model 3

Similarity score as predictor; conservatism, SDO, TIPI agreeableness, gender, race, ethnicity, income, education, and age as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(trust_natinst_z ~ simi_z + ideo_con_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)

```

### Model 4

Similarity score as predictor; conservatism, SDO, TIPI agreeableness, gender, race, ethnicity, income, education, age, county mediation income, county GINI coefficient, and county density as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(trust_natinst_z ~ simi_z + ideo_con_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z + county_medianincome_z + county_gini_z + county_density_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

# Exploratory analysis

Same models from the analysis plan, but with the following outcome variables: (1) Binary voting behavior; (2) trust in science.

## Outcome Variable: Binary voting behavior

### Model 1

Similarity score as predictor; conservatism as control.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(vote_tomorrow ~ simi_z + ideo_con_z ,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

### Model 2

Similarity score as predictor; conservatism, SDO, and TIPI agreeableness as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(vote_tomorrow ~ simi_z + ideo_con_z + SDO_z + TIPI_agree_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

### Model 3

Similarity score as predictor; conservatism, SDO, TIPI agreeableness, gender, race, ethnicity, income, education, and age as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(vote_tomorrow ~ simi_z + ideo_con_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)

```

### Model 4

Similarity score as predictor; conservatism, SDO, TIPI agreeableness, gender, race, ethnicity, income, education, age, county mediation income, county GINI coefficient, and county density as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(vote_tomorrow ~ simi_z + ideo_con_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z + county_medianincome_z + county_gini_z + county_density_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

## Outcome Variable: Trust in science

### Model 1

Similarity score as predictor; conservatism as control.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(trust_science ~ simi_z + ideo_con_z ,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

### Model 2

Similarity score as predictor; conservatism, SDO, and TIPI agreeableness as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(trust_science ~ simi_z + ideo_con_z + SDO_z + TIPI_agree_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

### Model 3

Similarity score as predictor; conservatism, SDO, TIPI agreeableness, gender, race, ethnicity, income, education, and age as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(trust_science ~ simi_z + ideo_con_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)

```

### Model 4

Similarity score as predictor; conservatism, SDO, TIPI agreeableness, gender, race, ethnicity, income, education, age, county mediation income, county GINI coefficient, and county density as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(trust_science ~ simi_z + ideo_con_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z + county_medianincome_z + county_gini_z + county_density_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

## Outcome Variable: Voting for Trump in 2024

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(vote_2024_trump ~ simi_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

## Outcome Variable: Voting for Biden in 2024

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(vote_2024_biden ~ simi_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

## Outcome Variable: Voting for RFK Jr. in 2024

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(vote_2024_rfkj ~ simi_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

## Outcome Variable: Voting for "other" in 2024

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(vote_2024_other ~ simi_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

# Similarity score from OpenAI

I'll do the same models as the analysis plan.

## Outcome Variable: Likelihood to vote in the 2024 Presidential election

#### Model 1

Similarity score as predictor; conservatism as control.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(vote_likely_z ~ simi_openai_z + ideo_con_z ,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)

```

### Model 2

Similarity score as predictor; conservatism, SDO, and TIPI agreeableness as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(vote_likely_z ~ simi_openai_z + ideo_con_z + SDO_z + TIPI_agree_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)

```

### Model 3

Similarity score as predictor; conservatism, SDO, TIPI agreeableness, gender, race, ethnicity, income, education, and age as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(vote_likely_z ~ simi_openai_z + ideo_con_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)

```

### Model 4

Similarity score as predictor; conservatism, SDO, TIPI agreeableness, gender, race, ethnicity, income, education, age, county mediation income, county GINI coefficient, and county density as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(vote_likely_z ~ simi_openai_z + ideo_con_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z + county_medianincome_z + county_gini_z + county_density_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)

```

## Outcome Variable: Support for radical change

### Model 1

Similarity score as predictor; conservatism as control.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(change_z ~ simi_openai_z + ideo_con_z ,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

### Model 2

Similarity score as predictor; conservatism, SDO, and TIPI agreeableness as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(change_z ~ simi_openai_z + ideo_con_z + SDO_z + TIPI_agree_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

### Model 3

Similarity score as predictor; conservatism, SDO, TIPI agreeableness, gender, race, ethnicity, income, education, and age as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(change_z ~ simi_openai_z + ideo_con_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)

```

### Model 4

Similarity score as predictor; conservatism, SDO, TIPI agreeableness, gender, race, ethnicity, income, education, age, county mediation income, county GINI coefficient, and county density as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(change_z ~ simi_openai_z + ideo_con_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z + county_medianincome_z + county_gini_z + county_density_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)

```

## Outcome Variable: Anti-establishment sentiment

### Model 1

Similarity score as predictor; conservatism as control.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(antiest_z ~ simi_openai_z + ideo_con_z ,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

### Model 2

Similarity score as predictor; conservatism, SDO, and TIPI agreeableness as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(antiest_z ~ simi_openai_z + ideo_con_z + SDO_z + TIPI_agree_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

### Model 3

Similarity score as predictor; conservatism, SDO, TIPI agreeableness, gender, race, ethnicity, income, education, and age as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(antiest_z ~ simi_openai_z + ideo_con_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)

```

### Model 4

Similarity score as predictor; conservatism, SDO, TIPI agreeableness, gender, race, ethnicity, income, education, age, county mediation income, county GINI coefficient, and county density as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(antiest_z ~ simi_openai_z + ideo_con_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z + county_medianincome_z + county_gini_z + county_density_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)

```

## Outcome Variable: Trust in democratic institutions

### Model 1

Similarity score as predictor; conservatism as control.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(trust_deminst_z ~ simi_openai_z + ideo_con_z ,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

### Model 2

Similarity score as predictor; conservatism, SDO, and TIPI agreeableness as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(trust_deminst_z ~ simi_openai_z + ideo_con_z + SDO_z + TIPI_agree_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

### Model 3

Similarity score as predictor; conservatism, SDO, TIPI agreeableness, gender, race, ethnicity, income, education, and age as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(trust_deminst_z ~ simi_openai_z + ideo_con_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)

```

### Model 4

Similarity score as predictor; conservatism, SDO, TIPI agreeableness, gender, race, ethnicity, income, education, age, county mediation income, county GINI coefficient, and county density as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(trust_deminst_z ~ simi_openai_z + ideo_con_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z + county_medianincome_z + county_gini_z + county_density_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)

```

## Outcome Variable: Trust in national mainstream institutions

### Model 1

Similarity score as predictor; conservatism as control.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(trust_natinst_z ~ simi_openai_z + ideo_con_z ,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

### Model 2

Similarity score as predictor; conservatism, SDO, and TIPI agreeableness as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(trust_natinst_z ~ simi_openai_z + ideo_con_z + SDO_z + TIPI_agree_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

### Model 3

Similarity score as predictor; conservatism, SDO, TIPI agreeableness, gender, race, ethnicity, income, education, and age as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(trust_natinst_z ~ simi_openai_z + ideo_con_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)

```

### Model 4

Similarity score as predictor; conservatism, SDO, TIPI agreeableness, gender, race, ethnicity, income, education, age, county mediation income, county GINI coefficient, and county density as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(trust_natinst_z ~ simi_openai_z + ideo_con_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z + county_medianincome_z + county_gini_z + county_density_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

# Similarity score from OpenAI

I'll do the same models as the analysis plan.

## Outcome Variable: Likelihood to vote in the 2024 Presidential election

#### Model 1

Similarity score as predictor; conservatism as control.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(vote_likely_z ~ brokencontract_openai_z + ideo_con_z ,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)

```

### Model 2

Similarity score as predictor; conservatism, SDO, and TIPI agreeableness as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(vote_likely_z ~ brokencontract_openai_z + ideo_con_z + SDO_z + TIPI_agree_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)

```

### Model 3

Similarity score as predictor; conservatism, SDO, TIPI agreeableness, gender, race, ethnicity, income, education, and age as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(vote_likely_z ~ brokencontract_openai_z + ideo_con_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)

```

### Model 4

Similarity score as predictor; conservatism, SDO, TIPI agreeableness, gender, race, ethnicity, income, education, age, county mediation income, county GINI coefficient, and county density as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(vote_likely_z ~ brokencontract_openai_z + ideo_con_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z + county_medianincome_z + county_gini_z + county_density_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)

```

## Outcome Variable: Support for radical change

### Model 1

Similarity score as predictor; conservatism as control.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(change_z ~ brokencontract_openai_z + ideo_con_z ,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

### Model 2

Similarity score as predictor; conservatism, SDO, and TIPI agreeableness as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(change_z ~ brokencontract_openai_z + ideo_con_z + SDO_z + TIPI_agree_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

### Model 3

Similarity score as predictor; conservatism, SDO, TIPI agreeableness, gender, race, ethnicity, income, education, and age as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(change_z ~ brokencontract_openai_z + ideo_con_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)

```

### Model 4

Similarity score as predictor; conservatism, SDO, TIPI agreeableness, gender, race, ethnicity, income, education, age, county mediation income, county GINI coefficient, and county density as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(change_z ~ brokencontract_openai_z + ideo_con_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z + county_medianincome_z + county_gini_z + county_density_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)

```

## Outcome Variable: Anti-establishment sentiment

### Model 1

Similarity score as predictor; conservatism as control.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(antiest_z ~ brokencontract_openai_z + ideo_con_z ,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

### Model 2

Similarity score as predictor; conservatism, SDO, and TIPI agreeableness as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(antiest_z ~ brokencontract_openai_z + ideo_con_z + SDO_z + TIPI_agree_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

### Model 3

Similarity score as predictor; conservatism, SDO, TIPI agreeableness, gender, race, ethnicity, income, education, and age as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(antiest_z ~ brokencontract_openai_z + ideo_con_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)

```

### Model 4

Similarity score as predictor; conservatism, SDO, TIPI agreeableness, gender, race, ethnicity, income, education, age, county mediation income, county GINI coefficient, and county density as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(antiest_z ~ brokencontract_openai_z + ideo_con_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z + county_medianincome_z + county_gini_z + county_density_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)

summary(m1)
```

## Outcome Variable: Trust in democratic institutions

### Model 1

Similarity score as predictor; conservatism as control.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(trust_deminst_z ~ brokencontract_openai_z + ideo_con_z ,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

### Model 2

Similarity score as predictor; conservatism, SDO, and TIPI agreeableness as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(trust_deminst_z ~ brokencontract_openai_z + ideo_con_z + SDO_z + TIPI_agree_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

### Model 3

Similarity score as predictor; conservatism, SDO, TIPI agreeableness, gender, race, ethnicity, income, education, and age as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(trust_deminst_z ~ brokencontract_openai_z + ideo_con_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)

```

### Model 4

Similarity score as predictor; conservatism, SDO, TIPI agreeableness, gender, race, ethnicity, income, education, age, county mediation income, county GINI coefficient, and county density as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(trust_deminst_z ~ brokencontract_openai_z + ideo_con_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z + county_medianincome_z + county_gini_z + county_density_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)

```

## Outcome Variable: Trust in national mainstream institutions

### Model 1

Similarity score as predictor; conservatism as control.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(trust_natinst_z ~ brokencontract_openai_z + ideo_con_z ,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

### Model 2

Similarity score as predictor; conservatism, SDO, and TIPI agreeableness as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(trust_natinst_z ~ brokencontract_openai_z + ideo_con_z + SDO_z + TIPI_agree_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

### Model 3

Similarity score as predictor; conservatism, SDO, TIPI agreeableness, gender, race, ethnicity, income, education, and age as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(trust_natinst_z ~ brokencontract_openai_z + ideo_con_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)

```

### Model 4

Similarity score as predictor; conservatism, SDO, TIPI agreeableness, gender, race, ethnicity, income, education, age, county mediation income, county GINI coefficient, and county density as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(trust_natinst_z ~ brokencontract_openai_z + ideo_con_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z + county_medianincome_z + county_gini_z + county_density_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```



# Interactions with political ideology

## Outcome variable: Support for radical change

### Conservatism

#### With controls\

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(change_z ~ simi_openai_z*ideo_con_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z + county_medianincome_z + county_gini_z + county_density_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)

summary(m1)
```

#### Without controls\

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(change_z ~ simi_openai_z*ideo_con_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)

summary(m1)
```

### Liberalism

#### With controls\

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(change_z ~ simi_openai_z*ideo_lib_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z + county_medianincome_z + county_gini_z + county_density_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

#### Without controls\

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(change_z ~ simi_openai_z*ideo_lib_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)

summary(m1)
```

### Democratic socialism

#### With controls\

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(change_z ~ simi_openai_z*ideo_demsoc_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z + county_medianincome_z + county_gini_z + county_density_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

#### Without controls\

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(change_z ~ simi_openai_z*ideo_demsoc_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)

summary(m1)
```

### Libertarianism

#### With controls\

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(change_z ~ simi_openai_z*ideo_lbrtn_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z + county_medianincome_z + county_gini_z + county_density_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

#### Without controls\

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(change_z ~ simi_openai_z*ideo_lbrtn_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

### Progressivism

#### With controls\

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(change_z ~ simi_openai_z*ideo_prog_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z + county_medianincome_z + county_gini_z + county_density_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

#### Without controls\

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(change_z ~ simi_openai_z*ideo_prog_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

## Outcome variable: Anti-establishment

### Conservatism

#### With controls\

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(antiest_z ~ simi_openai_z*ideo_con_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z + county_medianincome_z + county_gini_z + county_density_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

#### Without controls\

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(antiest_z ~ simi_openai_z*ideo_con_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

### Liberalism

#### With controls\

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(antiest_z ~ simi_openai_z*ideo_lib_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z + county_medianincome_z + county_gini_z + county_density_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

#### Without controls\

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(antiest_z ~ simi_openai_z*ideo_lib_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

### Democratic socialism

#### With controls\

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(antiest_z ~ simi_openai_z*ideo_demsoc_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z + county_medianincome_z + county_gini_z + county_density_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

#### Without controls\

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(antiest_z ~ simi_openai_z*ideo_demsoc_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

### Libertarianism

#### With controls\

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(antiest_z ~ simi_openai_z*ideo_lbrtn_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z + county_medianincome_z + county_gini_z + county_density_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

#### Without controls\

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(antiest_z ~ simi_openai_z*ideo_lbrtn_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

### Progressivism

#### With controls\

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(antiest_z ~ simi_openai_z*ideo_prog_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z + county_medianincome_z + county_gini_z + county_density_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

#### Without controls\

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(antiest_z ~ simi_openai_z*ideo_prog_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

## Outcome variable: Trust in democratic institutions

### Conservatism

#### With controls\

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(trust_deminst_z ~ simi_openai_z*ideo_con_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z + county_medianincome_z + county_gini_z + county_density_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

#### Without controls\

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(trust_deminst_z ~ simi_openai_z*ideo_con_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

### Liberalism

#### With controls\

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(trust_deminst_z ~ simi_openai_z*ideo_lib_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z + county_medianincome_z + county_gini_z + county_density_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

#### Without controls\

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(trust_deminst_z ~ simi_openai_z*ideo_lib_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

### Democratic socialism

#### With controls\

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(trust_deminst_z ~ simi_openai_z*ideo_demsoc_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z + county_medianincome_z + county_gini_z + county_density_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

#### Without controls\

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(trust_deminst_z ~ simi_openai_z*ideo_demsoc_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE,fig.dim=c(5,3)}
m1 <- lm(trust_deminst_z ~ simi_openai_z*ideo_demsoc_z,data = df_bsc_elg)

interact_plot(m1,
              pred = simi_openai_z,
              modx = ideo_demsoc_z,
              interval = T)
```

### Libertarianism

#### With controls\

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(trust_deminst_z ~ simi_openai_z*ideo_lbrtn_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z + county_medianincome_z + county_gini_z + county_density_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

#### Without controls\

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(trust_deminst_z ~ simi_openai_z*ideo_lbrtn_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

### Progressivism

#### With controls\

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(trust_deminst_z ~ simi_openai_z*ideo_prog_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z + county_medianincome_z + county_gini_z + county_density_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

#### Without controls\

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(trust_deminst_z ~ simi_openai_z*ideo_prog_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

# Extra questions

## Values by ideology

```{r}
df_valuesbyideology <- df_bsc_long %>% 
  left_join(df_bsc_elg %>% 
              select(PID,brokencontract_openai,party_id,ideo_con:ideo_prog) %>% 
              mutate(is_elg = 1),by = "PID") %>% 
  filter(is_elg == 1) %>% 
  select(PID,brokencontract_openai,type,value,weight,party_id,ideo_con:ideo_prog) %>% 
  mutate(is_con = ifelse(ideo_con > 4,1,0),
         is_lib = ifelse(ideo_lib > 4,1,0),
         is_demsoc = ifelse(ideo_demsoc > 4,1,0),
         is_lbrtn = ifelse(ideo_lbrtn > 4,1,0),
         is_prog = ifelse(ideo_prog > 4,1,0))
```

### Conservatives 

```{r}
df_valuesbyideology %>% 
  filter(is_con == 1) %>% 
  select(type,weight,value) %>% 
  group_by(type,value) %>% 
  summarise(n = n()) %>% 
  ungroup() %>% 
  arrange(type,desc(n)) %>%  
  group_by(type) %>% 
  slice(1:10) %>% 
  kbl() %>% 
  kable_styling(bootstrap_options = "hover",
                position = "left") %>% 
  scroll_box(width = "100%", height = "400px")
```

### Liberals

```{r}
df_valuesbyideology %>% 
  filter(is_lib == 1) %>% 
  select(type,weight,value) %>% 
  group_by(type,value) %>% 
  summarise(n = n()) %>% 
  ungroup() %>% 
  arrange(type,desc(n)) %>%  
  group_by(type) %>% 
  slice(1:10) %>% 
  kbl() %>% 
  kable_styling(bootstrap_options = "hover",
                position = "left") %>% 
  scroll_box(width = "100%", height = "400px")
```

### Democratic socialists

```{r}
df_valuesbyideology %>% 
  filter(is_demsoc == 1) %>% 
  select(type,weight,value) %>% 
  group_by(type,value) %>% 
  summarise(n = n()) %>% 
  ungroup() %>% 
  arrange(type,desc(n)) %>%  
  group_by(type) %>% 
  slice(1:10) %>% 
  kbl() %>% 
  kable_styling(bootstrap_options = "hover",
                position = "left") %>% 
  scroll_box(width = "100%", height = "400px")
```

```{r}
df_bsc_elg %>% 
  group_by(party_id) %>% 
  summarise(mean = mean(brokencontract_openai,na.rm = T),
            sd = sd(brokencontract_openai,na.rm = T)) %>% 
  ungroup()
```

# by ideology

```{r}
df_bsc_elg %>% 
  select(brokencontract_openai,ideo_con:ideo_prog) %>% 
  pivot_longer(-brokencontract_openai,
               names_to = "ideo",
               values_to = "score",
               names_prefix = "ideo_",
               values_drop_na = T) %>% 
  ggplot(aes(x = score,y = brokencontract_openai)) +
  geom_smooth(method = "lm") +
  facet_wrap(~ideo)

df_bsc_elg %>% 
  select(brokencontract_openai,ideo_con:ideo_prog) %>% 
  corPlot(stars = T)
```

```{r}
df_bsc_elg %>% 
  lm(change ~ brokencontract_openai*party_id,data = .) %>% 
  summary()

df_bsc_elg %>% 
  ggplot(aes(x = brokencontract_openai,y = trust_deminst,colour = party_id)) +
  geom_smooth(method = "lm")
```

