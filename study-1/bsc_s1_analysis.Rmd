---
title: "Broken Social Contract"
subtitle: "March 2024: Analysis"
output: 
  html_document:
    toc: yes
    toc_float: yes
    code_folding: hide
---

```{r setup, include=FALSE}
library(apa)
library(see)
library(lme4)
library(lmerTest)
library(interactions)
library(jtools)
library(gridExtra)
library(kableExtra)
library(apaTables)
library(papaja)
library(knitr)
library(psych)
library(GPArotation)
library(PerformanceAnalytics)
library(gt)
library(tidytext)
library(textdata)
library(tidyverse)
library(diagram)
library(factoextra)
library(SnowballC)
library(hunspell)
library(quanteda)

df_bsc <- read.csv("~/Google Drive/My Drive/american's dream/March 2024/data/df_bsc.csv")
df_bsc_long <- read.csv("~/Google Drive/My Drive/american's dream/March 2024/data/df_bsc_long.csv")
```

```{r,include=FALSE}
df_bsc <- df_bsc %>% 
  mutate(income = factor(income,c("$0-$20,000",
                                  "$20,001-$40,000",
                                  "$40,001-$60,000",
                                  "$60,001-$80,000",
                                  "$80,001-$100,000",
                                  "$100,001-$120,000",
                                  "$120,001-$140,000",
                                  "$140,001-$160,000",
                                  "$160,001-$180,000",
                                  "$180,001-$200,000",
                                  "Over $200,000")),
         edu = factor(edu,c("noHS",
                            "GED",
                            "2yearColl",
                            "4yearColl",
                            "MA",
                            "PHD")))

df_bsc_elg <- df_bsc %>% 
  filter(check_1 == 0 & check_2 == 0)
```

# Background

This is a preregistered nationally representative study.

## Description

In this project, we examine the role of a broken social contract in people’s trust in institutions and anti-establishment sentiment. Specifically, we identify, through various methods, gaps between what people believe they are promised by the government on paper and what they are being provided by the government in practice. We then examine the explanatory role this gap plays in various socio-political behavioral and attitudinal outcomes.

## Hypotheses

1. Similarity between perceived guiding values of the US on paper and perceived guiding values of the US in practice is positively associated with likelihood to vote in the 2024 Presidential Election.\
2. Similarity between perceived guiding values of the US on paper and perceived guiding values of the US in practice is negatively associated with support for radical change.\
3. Similarity between perceived guiding values of the US on paper and perceived guiding values of the US in practice is negatively associated with anti-establishment sentiment.\
4. Similarity between perceived guiding values of the US on paper and perceived guiding values of the US in practice is positively associated with trust in democratic institutions (executive, legislative, and judicial branch).\
5. Similarity between perceived guiding values of the US on paper and perceived guiding values of the US in practice is positively associated with trust in mainstream societal institutions (media, education, police, military, finance, medicine).

## Study design

Two major parts:\
1. Social contract: Participants will list the top five guiding values for the US on paper and the top five guiding values for the US in practice. For each of these perspectives, they will assign weights to each value based on its perceived importance to the US on paper and in practice, respectively.\
2. Attitudes and individual differences: Participants will complete measures of anti-establishment sentiment, trust in institutions, trust in science, SDO, TIPI, support for radical change, and political identification/behavior.

## Analysis plan

The following linear models will be conducted for each of these outcome variables: (1) Likelihood to vote in the 2024 Presidential election; (2) support for radical change; (3) anti-establishment sentiment; (4) trust in democratic institutions; (5) trust in mainstream societal institutions.\
\
1. Correlation matrix: Similarity score, likelihood to vote in the 2024 Presidential election, support for radical change, anti-establishment sentiment, trust in democratic institutions, trust in mainstream societal institutions, trust in science, conservatism, SDO, TIPI extraversion, TIPI agreeableness, TIPI Conscientiousness, TIPI neuroticism, TIPI openness.\
2. Linear Model 1: Similarity score as predictor; conservatism as control.\
3. Linear Model 2: Similarity score as predictor; conservatism, SDO, and TIPI agreeableness as controls.\
4. Linear Model 3: Similarity score as predictor; conservatism, SDO, TIPI agreeableness, gender, race, ethnicity, income, education, and age as controls.\
5. Linear Model 4: Similarity score as predictor; conservatism, SDO, TIPI agreeableness, gender, race, ethnicity, income, education, age, county mediation income, county GINI coefficient, and county density as controls. 


# Attention Check

But first, let's exclude participants who failed attention checks: one simple attention check imbedded in the anti-establishment scale and another with incoherent open-text.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
df_bsc %>% 
  group_by(check_1,check_2) %>% 
  summarise(N = n()) %>% 
  ungroup() %>% 
  mutate(Perc = round(100*(N/sum(N)),2)) %>% 
  ungroup() %>% 
  kbl() %>% 
  kable_styling(bootstrap_options = "hover",
                full_width = F,
                position = "left")
```

Great. That leaves us with 1188 eligible participants.

# Demographics

## Race and ethnicity

```{r,results='asis',echo=TRUE,warning=FALSE}
df_bsc_elg %>% 
  group_by(race,hispanic) %>% 
  summarise(N = n()) %>% 
  ungroup() %>% 
  mutate(Perc = round(100*(N/sum(N)),2)) %>% 
  ungroup() %>% 
  kbl() %>% 
  kable_styling(bootstrap_options = "hover",
                full_width = F,
                position = "left")
```

## Gender

```{r,echo=TRUE,results='asis',warning=FALSE}
df_bsc_elg %>% 
  mutate(gender = ifelse(is.na(gender) | gender == "","other",gender)) %>% 
  group_by(gender) %>% 
  summarise(N = n()) %>% 
  ungroup() %>% 
  mutate(Perc = round(100*(N/sum(N)),2)) %>% 
  ungroup() %>% 
  kbl() %>% 
  kable_styling(bootstrap_options = "hover",
                full_width = F,
                position = "left")
```

## Age

```{r,echo=TRUE,results='asis',warning=FALSE}
df_bsc_elg %>% 
  summarise(age_mean = round(mean(age,na.rm = T),2),
            age_sd = round(sd(age,na.rm = T),2)) %>% 
  kbl() %>% 
  kable_styling(bootstrap_options = "hover",
                full_width = F,
                position = "left")
```

## Education

```{r,echo=TRUE,results='asis',warning=FALSE}
df_bsc_elg %>% 
  group_by(edu) %>% 
  summarise(N = n()) %>% 
  ungroup() %>% 
  mutate(Perc = round(100*(N/sum(N)),2)) %>% 
  ungroup() %>% 
  kbl() %>% 
  kable_styling(bootstrap_options = "hover",
                full_width = F,
                position = "left")
```

## Income

```{r,fig.align='left',echo=TRUE,warning=FALSE,fig.dim=c(5,3)}
df_bsc_elg %>% 
  ggplot(aes(x = income)) +
  geom_bar() +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.background = element_blank(),
        axis.ticks = element_blank(),
        axis.line = element_line(color = "grey66"),
        axis.text.y = element_text(color = "black"),
        axis.text.x = element_text(color = "black",
                                   face = "bold"),
        axis.title.x = element_blank(),
        axis.title.y = element_blank()) +
  coord_flip()

png("fig1.png", width = 20, height = 9, units = "in",res = 1200, bg = "transparent")
df_bsc_elg %>% 
  ggplot(aes(x = income)) +
  geom_bar() +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.background = element_blank(),
        axis.ticks = element_blank(),
        axis.line = element_line(color = "grey66"),
        axis.text.y = element_text(color = "black"),
        axis.text.x = element_text(color = "black",
                                   face = "bold",
                                   angle = 270),
        axis.title.x = element_blank(),
        axis.title.y = element_blank())

df_bsc_elg %>% 
  ggplot(aes(x = income_num)) +
  geom_histogram(binwidth = 1,
                 color = "black",
                 fill = "lightblue") +
  scale_x_continuous(limits = c(0,13))

df_bsc_elg %>% 
  group_by(income) %>% 
  summarise(n = n())
```

# Politics

## Ideology

Participants were asked about the extent to which they subscribe to the following ideologies on a scale of 1-7 (select NA if unfamiliar): Conservatism, Liberalism, Democratic Socialism, Libertarianism, Progressivism.

```{r,fig.align='left',echo=TRUE,warning=FALSE,fig.dim=c(7,5)}
means <- df_bsc_elg %>%
  dplyr::select(PID,ideo_con:ideo_prog) %>% 
  pivot_longer(-PID,
               names_to = "ideo",
               values_to = "score") %>% 
  filter(!is.na(score)) %>% 
  group_by(ideo) %>% 
  summarise(score = mean(score)) %>% 
  ungroup()

df_bsc_elg %>%
  dplyr::select(PID,ideo_con:ideo_prog) %>% 
  pivot_longer(-PID,
               names_to = "ideo",
               values_to = "score") %>% 
  filter(!is.na(score)) %>%  
  ggplot() +
  geom_density(aes(x = score), fill = "lightblue") +
  scale_x_continuous(limits = c(1,7),
                     breaks = seq(1,7,1)) +
  geom_vline(data = means,mapping = aes(xintercept = score),
             color = "black",
             linetype = "dashed",
             size = 1.1) +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.background = element_blank(),
        axis.ticks = element_blank(),
        axis.line = element_line(color = "grey66"),
        axis.text.y = element_text(color = "black"),
        axis.text.x = element_text(color = "black",
                                   face = "bold")) +
  facet_wrap(~ideo,nrow = 2)

```

## Party ID

```{r,echo=TRUE,results='asis',warning=FALSE}
df_bsc_elg %>% 
  group_by(party_id) %>% 
  summarise(N = n()) %>% 
  ungroup() %>% 
  mutate(Perc = round(100*(N/sum(N)),2)) %>% 
  ungroup() %>% 
  kbl() %>% 
  kable_styling(bootstrap_options = "hover",
                full_width = F,
                position = "left")
```

## Vote in 2020

```{r,echo=TRUE,results='asis',warning=FALSE}
df_bsc_elg %>% 
  group_by(vote_2020) %>% 
  summarise(N = n()) %>% 
  ungroup() %>% 
  mutate(Perc = round(100*(N/sum(N)),2)) %>% 
  ungroup() %>% 
  arrange(desc(N)) %>% 
  kbl() %>% 
  kable_styling(bootstrap_options = "hover",
                full_width = F,
                position = "left")
```

## Vote in 2024

```{r,echo=TRUE,results='asis',warning=FALSE}
df_bsc_elg %>% 
  group_by(vote_2024) %>% 
  summarise(N = n()) %>% 
  ungroup() %>% 
  mutate(Perc = round(100*(N/sum(N)),2)) %>% 
  ungroup() %>% 
  arrange(desc(N)) %>% 
  kbl() %>% 
  kable_styling(bootstrap_options = "hover",
                full_width = F,
                position = "left")
```


# Measures

## Open responses

First, I'll just show the values mentioned for each perspective.

### US on paper

```{r,echo=TRUE,results='asis',warning=FALSE,message=FALSE}
df_bsc_long %>%
  left_join(df_bsc_elg %>% 
              dplyr::select(PID) %>% 
              mutate(elg = 1),by = "PID") %>% 
  filter(!is.na(elg)) %>% 
  dplyr::select(type,value) %>%
  filter(type == "uspaper") %>% 
  group_by(value) %>% 
  summarise(N = n()) %>% 
  ungroup() %>% 
  mutate(Perc = round(100*(N/sum(N)),2)) %>% 
  ungroup() %>% 
  arrange(desc(N)) %>% 
  dplyr::select(N,Perc,value) %>% 
  kbl() %>% 
  kable_styling(bootstrap_options = "hover",
                position = "left") %>% 
  scroll_box(width = "100%", height = "400px")
```

### US in practice

```{r,echo=TRUE,results='asis',warning=FALSE,message=FALSE}
df_bsc_long %>%
  left_join(df_bsc_elg %>% 
              dplyr::select(PID) %>% 
              mutate(elg = 1),by = "PID") %>% 
  filter(!is.na(elg)) %>% 
  dplyr::select(type,value) %>%
  filter(type == "uspractice") %>% 
  group_by(value) %>% 
  summarise(N = n()) %>% 
  ungroup() %>% 
  mutate(Perc = round(100*(N/sum(N)),2)) %>% 
  ungroup() %>% 
  arrange(desc(N)) %>% 
  dplyr::select(N,Perc,value) %>% 
  kbl() %>% 
  kable_styling(bootstrap_options = "hover",
                position = "left") %>% 
  scroll_box(width = "100%", height = "400px")
```

## Cosine similarity: GloVe

After getting the values' semantic meaning in 100-dimension vectors, I took the weighted mean of each perspective per participant and took the cosine similarity between the two persepctives' vectors. This is the distribution:

```{r,fig.align='left',echo=TRUE,warning=FALSE,fig.dim=c(5,3)}
df_bsc_elg %>%
  ggplot() +
  geom_density(aes(x = simi), fill = "lightblue") +
  geom_vline(xintercept = mean(df_bsc_elg$simi,na.rm = T),
             color = "black",
             linetype = "dashed",
             size = 1.1) +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.background = element_blank(),
        axis.ticks = element_blank(),
        axis.line = element_line(color = "grey66"),
        axis.text.y = element_text(color = "black"),
        axis.text.x = element_text(color = "black",
                                   face = "bold"))

```

## Cosine similarity: OpenAI

I also got word embeddings through the OpenAI API. There, I used the [text-embedding-3-large] model that gives 3072 dimensions per term. It's much more exhaustive and much more precise. Then, I did the same procesure for the weighted cosine similarities.

```{r,fig.align='left',echo=TRUE,warning=FALSE,fig.dim=c(5,3)}
df_bsc_elg %>%
  ggplot() +
  geom_density(aes(x = simi_openai), fill = "lightblue") +
  geom_vline(xintercept = mean(df_bsc_elg$simi_openai,na.rm = T),
             color = "black",
             linetype = "dashed",
             size = 1.1) +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.background = element_blank(),
        axis.ticks = element_blank(),
        axis.line = element_line(color = "grey66"),
        axis.text.y = element_text(color = "black"),
        axis.text.x = element_text(color = "black",
                                   face = "bold"))

```

## Anti-Establishment

```{r,include=F}
alpha_table <- df_bsc_elg %>% 
  dplyr::select(antiest_1,
                antiest_2,
                antiest_3,
                antiest_4R) %>% 
  psych::alpha()

alpha <- alpha_table$total[1]
```

1. The US’s economy is rigged to advantage the rich and powerful\
2. Traditional politicians and parties don’t care about people like me\
3. Experts in this country don’t understand the lives of people like me\
4. Most of the time we can trust people in the government to do what is right [R]
\
alpha = `r round(alpha,2)`

```{r,fig.align='left',echo=TRUE,warning=FALSE,fig.dim=c(5,3)}
df_bsc_elg %>% 
  ggplot(aes(x = antiest)) +
  geom_density(fill = "lightblue",
                 color = "black") +
  scale_x_continuous(breaks = seq(1,7,1),
                     limits = c(1,7)) +
  ylab("density") +
  geom_vline(xintercept = mean(df_bsc_elg$antiest,na.rm = T),
             color = "black",
             linetype = "dashed",
             size = 1.1) +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.background = element_blank(),
        axis.ticks = element_blank(),
        axis.line = element_line(color = "grey66"),
        axis.text.y = element_text(color = "black"),
        axis.text.x = element_text(color = "black",
                                   face = "bold"),
        axis.title.x = element_text(color = "black",
                                   face = "bold"))
```

## Trust in democratic institutions

```{r,include=F}
alpha_table <- df_bsc_elg %>% 
  dplyr::select(trust_congress:trust_courts) %>% 
  psych::alpha()

alpha <- alpha_table$total[1]
```

Please indicate how much you trust or distrust the following institutions (1 = Strongly *Distrust* to 7 = *Strongly Trust*)\
\
1. The US Congress / Legislative Branch\
2. The US Government / Executive Branch\
3. The US Courts / Judicial Branch\
\
alpha = `r round(alpha,2)`

```{r,fig.align='left',echo=TRUE,warning=FALSE,fig.dim=c(5,3)}
df_bsc_elg %>% 
  ggplot(aes(x = trust_deminst)) +
  geom_density(fill = "lightblue",
                 color = "black") +
  scale_x_continuous(breaks = seq(1,7,1),
                     limits = c(1,7)) +
  ylab("density") +
  geom_vline(xintercept = mean(df_bsc_elg$trust_deminst,na.rm = T),
             color = "black",
             linetype = "dashed",
             size = 1.1) +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.background = element_blank(),
        axis.ticks = element_blank(),
        axis.line = element_line(color = "grey66"),
        axis.text.y = element_text(color = "black"),
        axis.text.x = element_text(color = "black",
                                   face = "bold"),
        axis.title.x = element_text(color = "black",
                                   face = "bold"))
```

## Trust in national mainstream institutions

```{r,include=F}
alpha_table <- df_bsc_elg %>% 
  dplyr::select(trust_media,
                trust_edu,
                trust_police,
                trust_millitary,
                trust_finance,
                trust_med) %>% 
  psych::alpha()

alpha <- alpha_table$total[1]
```

Please indicate how much you trust or distrust the following institutions (1 = Strongly *Distrust* to 7 = *Strongly Trust*)\
\
1. Mainstream media in the US (e.g., CNN, FOX News, MSNBC, New York Times, Wall-Street Journal, USA Today) \
2. The education system in the US\
3. Law enforcement / police in the US\
4. The US Military\
5. Financial institutions in the US (e.g., Wall Street, The Fed, The Big Banks)\
6. The medical system in the US\
\
alpha = `r round(alpha,2)`

```{r,fig.align='left',echo=TRUE,warning=FALSE,fig.dim=c(5,3)}
df_bsc_elg %>% 
  ggplot(aes(x = trust_natinst)) +
  geom_density(fill = "lightblue",
                 color = "black") +
  scale_x_continuous(breaks = seq(1,7,1),
                     limits = c(1,7)) +
  ylab("density") +
  geom_vline(xintercept = mean(df_bsc_elg$trust_natinst,na.rm = T),
             color = "black",
             linetype = "dashed",
             size = 1.1) +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.background = element_blank(),
        axis.ticks = element_blank(),
        axis.line = element_line(color = "grey66"),
        axis.text.y = element_text(color = "black"),
        axis.text.x = element_text(color = "black",
                                   face = "bold"),
        axis.title.x = element_text(color = "black",
                                   face = "bold"))
```

## Trust in science

```{r,include=F}
alpha_table <- df_bsc_elg %>% 
  dplyr::select(trust_science_1,
                trust_science_2,
                trust_science_3) %>% 
  psych::alpha()

alpha <- alpha_table$total[1]
```

Please indicate how much you agree or disagree with the following statements (1 = *Strongly Disagree* to 7 = *Strongly Agree*)\
\
1. I generally trust the recommendations of scientists\
2. Scientific institutions generate objective knowledge\
3. I look to the social sciences for answers to social problems\
\
alpha = `r round(alpha,2)`

```{r,fig.align='left',echo=TRUE,warning=FALSE,fig.dim=c(5,3)}
df_bsc_elg %>% 
  ggplot(aes(x = trust_science)) +
  geom_density(fill = "lightblue",
                 color = "black") +
  scale_x_continuous(breaks = seq(1,7,1),
                     limits = c(1,7)) +
  ylab("density") +
  geom_vline(xintercept = mean(df_bsc_elg$trust_science,na.rm = T),
             color = "black",
             linetype = "dashed",
             size = 1.1) +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.background = element_blank(),
        axis.ticks = element_blank(),
        axis.line = element_line(color = "grey66"),
        axis.text.y = element_text(color = "black"),
        axis.text.x = element_text(color = "black",
                                   face = "bold"),
        axis.title.x = element_text(color = "black",
                                   face = "bold"))
```

## Support for radical change

To what extent do you agree with the following statement?\
\
*The way this country works needs to be radically changed*

```{r,fig.align='left',echo=TRUE,warning=FALSE,fig.dim=c(5,3)}
df_bsc_elg %>% 
  ggplot(aes(x = change)) +
  geom_density(fill = "lightblue",
                 color = "black") +
  scale_x_continuous(breaks = seq(1,7,1),
                     limits = c(1,7)) +
  ylab("density") +
  geom_vline(xintercept = mean(df_bsc_elg$change,na.rm = T),
             color = "black",
             linetype = "dashed",
             size = 1.1) +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.background = element_blank(),
        axis.ticks = element_blank(),
        axis.line = element_line(color = "grey66"),
        axis.text.y = element_text(color = "black"),
        axis.text.x = element_text(color = "black",
                                   face = "bold"),
        axis.title.x = element_text(color = "black",
                                   face = "bold"))
```

## SDO

```{r,include=F}
alpha_table <- df_bsc_elg %>% 
  dplyr::select(SDO_1:SDO_8R) %>% 
  psych::alpha()

alpha <- alpha_table$total[1]
```

1. An ideal society requires some groups to be on top and others to be on the bottom\
2. Some groups of people are simply inferior to other groups\
3. No one group should dominate in society [R]\
4. Groups at the bottom are just as deserving as groups at the top [R]\
5. Group equality should not be our primary goal\
6. It is unjust to try to make groups equal\
7. We should do what we can to equalize conditions for different groups [R]\
8. We should work to give all groups an equal chance to succeed [R]\
\
alpha = `r round(alpha,2)`

```{r,fig.align='left',echo=TRUE,warning=FALSE,fig.dim=c(5,3)}
df_bsc_elg %>% 
  ggplot(aes(x = SDO)) +
  geom_density(fill = "lightblue",
                 color = "black") +
  scale_x_continuous(breaks = seq(1,7,1),
                     limits = c(1,7)) +
  ylab("density") +
  geom_vline(xintercept = mean(df_bsc_elg$SDO,na.rm = T),
             color = "grey15",
             size = 1,
             linetype = "dashed") +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.background = element_blank(),
        axis.ticks = element_blank(),
        axis.line = element_line(color = "grey66"),
        axis.text.y = element_text(color = "black"),
        axis.text.x = element_text(color = "black",
                                   face = "bold"),
        axis.title.x = element_text(color = "black",
                                   face = "bold"))
```

## TIPI

I see myself as... (1 = *Strongly Disagree* to 7 = *Strongly Agree*)

1. Extraverted, enthusiastic\
2. Critical, quarrelsome [R]\
3. Dependable, self-disciplined\
4. Anxious, easily upset\
5. Open to new experiences, complex\
6. Reserved, quiet [R]\
7. Sympathetic, warm\
8. Disorganized, careless [R]\
9. Calm, emotionally stable [R]\
10. Conventional, uncreative [R]\
\
**Extraversion:** Mean score of items 1 and 6\
**Agreeableness:** Mean score of items 2 and 7\
**Conscientiousness:** Mean score of items 3 and 8\
**Neuroticism:** Mean score of items 4 and 9\
**Openness:** Mean score of items 5 and 10


```{r,fig.align='left',echo=TRUE,warning=FALSE,fig.dim=c(7,5)}
means <- df_bsc_elg %>%
  dplyr::select(PID,TIPI_extra:TIPI_open) %>% 
  pivot_longer(-PID,
               names_to = "trait",
               values_to = "score") %>% 
  filter(!is.na(score)) %>% 
  group_by(trait) %>% 
  summarise(score = mean(score)) %>% 
  ungroup()

df_bsc_elg %>%
  dplyr::select(PID,TIPI_extra:TIPI_open) %>% 
  pivot_longer(-PID,
               names_to = "trait",
               values_to = "score") %>% 
  filter(!is.na(score)) %>%  
  ggplot() +
  geom_density(aes(x = score), fill = "lightblue") +
  scale_x_continuous(limits = c(1,7),
                     breaks = seq(1,7,1)) +
  geom_vline(data = means,mapping = aes(xintercept = score),
             color = "black",
             linetype = "dashed",
             size = 1.1) +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.background = element_blank(),
        axis.ticks = element_blank(),
        axis.line = element_line(color = "grey66"),
        axis.text.y = element_text(color = "black"),
        axis.text.x = element_text(color = "black",
                                   face = "bold")) +
  facet_wrap(~trait,nrow = 2)

```

## Voting intentions

What is the likelihood that you will vote in the 2024 Presidential Elections?

```{r,fig.align='left',echo=TRUE,warning=FALSE,fig.dim=c(5,3)}
df_bsc_elg %>% 
  ggplot(aes(x = vote_likely)) +
  geom_histogram(fill = "lightblue",
                 color = "black",
                 binwidth = 1) +
  scale_x_continuous(breaks = seq(1,5,1),
                     limits = c(0,6)) +
  ylab("density") +
  geom_vline(xintercept = mean(df_bsc_elg$vote_likely,na.rm = T),
             color = "grey15",
             size = 1,
             linetype = "dashed") +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.background = element_blank(),
        axis.ticks = element_blank(),
        axis.line = element_line(color = "grey66"),
        axis.text.y = element_text(color = "black"),
        axis.text.x = element_text(color = "black",
                                   face = "bold"),
        axis.title.x = element_text(color = "black",
                                   face = "bold"))
```

# Analysis

## Correlation matrix

Similarity score, likelihood to vote in the 2024 Presidential election, support for radical change, anti-establishment sentiment, trust in democratic institutions, trust in mainstream societal institutions, trust in science, conservatism, SDO, TIPI extraversion, TIPI agreeableness, TIPI Conscientiousness, TIPI neuroticism, TIPI openness.

```{r,fig.align='left',echo=TRUE,warning=FALSE,message=FALSE,fig.dim=c(9,9)}
df_bsc_elg %>% 
  dplyr::select(simi,simi_openai,brokencontract_glove,brokencontract_openai,vote_likely,change,antiest:trust_science,SDO,ideo_con,TIPI_extra:TIPI_open) %>%
  corPlot(upper = TRUE,stars = TRUE,xsrt = 270)
```

```{r,include=FALSE}
df_bsc_elg <- df_bsc_elg %>% 
  mutate(simi_z = scale(simi),
         simi_openai_z = scale(simi_openai),
         brokencontract_glove_z = scale(brokencontract_glove),
         brokencontract_openai_z = scale(brokencontract_openai),
         vote_likely_z = scale(vote_likely),
         change_z = scale(change),
         antiest_z = scale(antiest),
         trust_deminst_z = scale(trust_deminst),
         trust_natinst_z = scale(trust_natinst),
         trust_science_z = scale(trust_science),
         ideo_con_z = scale(ideo_con),
         ideo_lib_z = scale(ideo_lib),
         ideo_demsoc_z = scale(ideo_demsoc),
         ideo_lbrtn_z = scale(ideo_lbrtn),
         ideo_prog_z = scale(ideo_prog),
         SDO_z = scale(SDO),
         TIPI_agree_z = scale(TIPI_agree),
         income_num_z = scale(income_num),
         edu_num_z = scale(edu_num),
         age_z = scale(age),
         county_density_z = scale(as.numeric(county_density)),
         county_gini_z = scale(as.numeric(county_gini)),
         county_medianincome_z = scale(as.numeric(county_medianincome)))
```


## Outcome Variable: Likelihood to vote in the 2024 Presidential election

### Model 1

Similarity score as predictor; conservatism as control.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(vote_likely_z ~ simi_z + ideo_con_z ,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)

```

### Model 2

Similarity score as predictor; conservatism, SDO, and TIPI agreeableness as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(vote_likely_z ~ simi_z + ideo_con_z + SDO_z + TIPI_agree_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)

```

### Model 3

Similarity score as predictor; conservatism, SDO, TIPI agreeableness, gender, race, ethnicity, income, education, and age as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(vote_likely_z ~ simi_z + ideo_con_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)

```

### Model 4

Similarity score as predictor; conservatism, SDO, TIPI agreeableness, gender, race, ethnicity, income, education, age, county mediation income, county GINI coefficient, and county density as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(vote_likely_z ~ simi_z + ideo_con_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z + county_medianincome_z + county_gini_z + county_density_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)

```

## Outcome Variable: Support for radical change

### Model 1

Similarity score as predictor; conservatism as control.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(change_z ~ simi_z + ideo_con_z ,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

### Model 2

Similarity score as predictor; conservatism, SDO, and TIPI agreeableness as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(change_z ~ simi_z + ideo_con_z + SDO_z + TIPI_agree_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

### Model 3

Similarity score as predictor; conservatism, SDO, TIPI agreeableness, gender, race, ethnicity, income, education, and age as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(change_z ~ simi_z + ideo_con_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)

```

### Model 4

Similarity score as predictor; conservatism, SDO, TIPI agreeableness, gender, race, ethnicity, income, education, age, county mediation income, county GINI coefficient, and county density as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(change_z ~ simi_z + ideo_con_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z + county_medianincome_z + county_gini_z + county_density_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

## Outcome Variable: Anti-establishment sentiment

### Model 1

Similarity score as predictor; conservatism as control.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(antiest_z ~ simi_z + ideo_con_z ,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

### Model 2

Similarity score as predictor; conservatism, SDO, and TIPI agreeableness as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(antiest_z ~ simi_z + ideo_con_z + SDO_z + TIPI_agree_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

### Model 3

Similarity score as predictor; conservatism, SDO, TIPI agreeableness, gender, race, ethnicity, income, education, and age as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(antiest_z ~ simi_z + ideo_con_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)

```

### Model 4

Similarity score as predictor; conservatism, SDO, TIPI agreeableness, gender, race, ethnicity, income, education, age, county mediation income, county GINI coefficient, and county density as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(antiest_z ~ simi_z + ideo_con_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z + county_medianincome_z + county_gini_z + county_density_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

## Outcome Variable: Trust in democratic institutions

### Model 1

Similarity score as predictor; conservatism as control.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(trust_deminst_z ~ simi_z + ideo_con_z ,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

### Model 2

Similarity score as predictor; conservatism, SDO, and TIPI agreeableness as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(trust_deminst_z ~ simi_z + ideo_con_z + SDO_z + TIPI_agree_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

### Model 3

Similarity score as predictor; conservatism, SDO, TIPI agreeableness, gender, race, ethnicity, income, education, and age as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(trust_deminst_z ~ simi_z + ideo_con_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)

```

### Model 4

Similarity score as predictor; conservatism, SDO, TIPI agreeableness, gender, race, ethnicity, income, education, age, county mediation income, county GINI coefficient, and county density as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(trust_deminst_z ~ simi_z + ideo_con_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z + county_medianincome_z + county_gini_z + county_density_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

## Outcome Variable: Trust in national mainstream institutions

### Model 1

Similarity score as predictor; conservatism as control.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(trust_natinst_z ~ simi_z + ideo_con_z ,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

### Model 2

Similarity score as predictor; conservatism, SDO, and TIPI agreeableness as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(trust_natinst_z ~ simi_z + ideo_con_z + SDO_z + TIPI_agree_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

### Model 3

Similarity score as predictor; conservatism, SDO, TIPI agreeableness, gender, race, ethnicity, income, education, and age as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(trust_natinst_z ~ simi_z + ideo_con_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)

```

### Model 4

Similarity score as predictor; conservatism, SDO, TIPI agreeableness, gender, race, ethnicity, income, education, age, county mediation income, county GINI coefficient, and county density as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(trust_natinst_z ~ simi_z + ideo_con_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z + county_medianincome_z + county_gini_z + county_density_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

# Exploratory analysis

Same models from the analysis plan, but with the following outcome variables: (1) Binary voting behavior; (2) trust in science.

## Outcome Variable: Binary voting behavior

### Model 1

Similarity score as predictor; conservatism as control.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(vote_tomorrow ~ simi_z + ideo_con_z ,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

### Model 2

Similarity score as predictor; conservatism, SDO, and TIPI agreeableness as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(vote_tomorrow ~ simi_z + ideo_con_z + SDO_z + TIPI_agree_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

### Model 3

Similarity score as predictor; conservatism, SDO, TIPI agreeableness, gender, race, ethnicity, income, education, and age as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(vote_tomorrow ~ simi_z + ideo_con_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)

```

### Model 4

Similarity score as predictor; conservatism, SDO, TIPI agreeableness, gender, race, ethnicity, income, education, age, county mediation income, county GINI coefficient, and county density as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(vote_tomorrow ~ simi_z + ideo_con_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z + county_medianincome_z + county_gini_z + county_density_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

## Outcome Variable: Trust in science

### Model 1

Similarity score as predictor; conservatism as control.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(trust_science ~ simi_z + ideo_con_z ,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

### Model 2

Similarity score as predictor; conservatism, SDO, and TIPI agreeableness as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(trust_science ~ simi_z + ideo_con_z + SDO_z + TIPI_agree_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

### Model 3

Similarity score as predictor; conservatism, SDO, TIPI agreeableness, gender, race, ethnicity, income, education, and age as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(trust_science ~ simi_z + ideo_con_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)

```

### Model 4

Similarity score as predictor; conservatism, SDO, TIPI agreeableness, gender, race, ethnicity, income, education, age, county mediation income, county GINI coefficient, and county density as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(trust_science ~ simi_z + ideo_con_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z + county_medianincome_z + county_gini_z + county_density_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

## Outcome Variable: Voting for Trump in 2024

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(vote_2024_trump ~ simi_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

## Outcome Variable: Voting for Biden in 2024

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(vote_2024_biden ~ simi_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

## Outcome Variable: Voting for RFK Jr. in 2024

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(vote_2024_rfkj ~ simi_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

## Outcome Variable: Voting for "other" in 2024

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(vote_2024_other ~ simi_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

# Similarity score from OpenAI

I'll do the same models as the analysis plan.

## Outcome Variable: Likelihood to vote in the 2024 Presidential election

#### Model 1

Similarity score as predictor; conservatism as control.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(vote_likely_z ~ simi_openai_z + ideo_con_z ,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)

```

### Model 2

Similarity score as predictor; conservatism, SDO, and TIPI agreeableness as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(vote_likely_z ~ simi_openai_z + ideo_con_z + SDO_z + TIPI_agree_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)

```

### Model 3

Similarity score as predictor; conservatism, SDO, TIPI agreeableness, gender, race, ethnicity, income, education, and age as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(vote_likely_z ~ simi_openai_z + ideo_con_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)

```

### Model 4

Similarity score as predictor; conservatism, SDO, TIPI agreeableness, gender, race, ethnicity, income, education, age, county mediation income, county GINI coefficient, and county density as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(vote_likely_z ~ simi_openai_z + ideo_con_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z + county_medianincome_z + county_gini_z + county_density_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)

```

## Outcome Variable: Support for radical change

### Model 1

Similarity score as predictor; conservatism as control.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(change_z ~ simi_openai_z + ideo_con_z ,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

### Model 2

Similarity score as predictor; conservatism, SDO, and TIPI agreeableness as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(change_z ~ simi_openai_z + ideo_con_z + SDO_z + TIPI_agree_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

### Model 3

Similarity score as predictor; conservatism, SDO, TIPI agreeableness, gender, race, ethnicity, income, education, and age as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(change_z ~ simi_openai_z + ideo_con_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)

```

### Model 4

Similarity score as predictor; conservatism, SDO, TIPI agreeableness, gender, race, ethnicity, income, education, age, county mediation income, county GINI coefficient, and county density as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(change_z ~ simi_openai_z + ideo_con_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z + county_medianincome_z + county_gini_z + county_density_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)

```

## Outcome Variable: Anti-establishment sentiment

### Model 1

Similarity score as predictor; conservatism as control.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(antiest_z ~ simi_openai_z + ideo_con_z ,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

### Model 2

Similarity score as predictor; conservatism, SDO, and TIPI agreeableness as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(antiest_z ~ simi_openai_z + ideo_con_z + SDO_z + TIPI_agree_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

### Model 3

Similarity score as predictor; conservatism, SDO, TIPI agreeableness, gender, race, ethnicity, income, education, and age as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(antiest_z ~ simi_openai_z + ideo_con_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)

```

### Model 4

Similarity score as predictor; conservatism, SDO, TIPI agreeableness, gender, race, ethnicity, income, education, age, county mediation income, county GINI coefficient, and county density as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(antiest_z ~ simi_openai_z + ideo_con_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z + county_medianincome_z + county_gini_z + county_density_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)

```

## Outcome Variable: Trust in democratic institutions

### Model 1

Similarity score as predictor; conservatism as control.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(trust_deminst_z ~ simi_openai_z + ideo_con_z ,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

### Model 2

Similarity score as predictor; conservatism, SDO, and TIPI agreeableness as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(trust_deminst_z ~ simi_openai_z + ideo_con_z + SDO_z + TIPI_agree_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

### Model 3

Similarity score as predictor; conservatism, SDO, TIPI agreeableness, gender, race, ethnicity, income, education, and age as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(trust_deminst_z ~ simi_openai_z + ideo_con_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)

```

### Model 4

Similarity score as predictor; conservatism, SDO, TIPI agreeableness, gender, race, ethnicity, income, education, age, county mediation income, county GINI coefficient, and county density as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(trust_deminst_z ~ simi_openai_z + ideo_con_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z + county_medianincome_z + county_gini_z + county_density_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)

```

## Outcome Variable: Trust in national mainstream institutions

### Model 1

Similarity score as predictor; conservatism as control.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(trust_natinst_z ~ simi_openai_z + ideo_con_z ,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

### Model 2

Similarity score as predictor; conservatism, SDO, and TIPI agreeableness as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(trust_natinst_z ~ simi_openai_z + ideo_con_z + SDO_z + TIPI_agree_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

### Model 3

Similarity score as predictor; conservatism, SDO, TIPI agreeableness, gender, race, ethnicity, income, education, and age as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(trust_natinst_z ~ simi_openai_z + ideo_con_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)

```

### Model 4

Similarity score as predictor; conservatism, SDO, TIPI agreeableness, gender, race, ethnicity, income, education, age, county mediation income, county GINI coefficient, and county density as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(trust_natinst_z ~ simi_openai_z + ideo_con_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z + county_medianincome_z + county_gini_z + county_density_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

# Similarity score from OpenAI

I'll do the same models as the analysis plan.

## Outcome Variable: Likelihood to vote in the 2024 Presidential election

#### Model 1

Similarity score as predictor; conservatism as control.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(vote_likely_z ~ brokencontract_openai_z + ideo_con_z ,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)

```

### Model 2

Similarity score as predictor; conservatism, SDO, and TIPI agreeableness as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(vote_likely_z ~ brokencontract_openai_z + ideo_con_z + SDO_z + TIPI_agree_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)

```

### Model 3

Similarity score as predictor; conservatism, SDO, TIPI agreeableness, gender, race, ethnicity, income, education, and age as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(vote_likely_z ~ brokencontract_openai_z + ideo_con_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)

```

### Model 4

Similarity score as predictor; conservatism, SDO, TIPI agreeableness, gender, race, ethnicity, income, education, age, county mediation income, county GINI coefficient, and county density as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(vote_likely_z ~ brokencontract_openai_z + ideo_con_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z + county_medianincome_z + county_gini_z + county_density_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)

```

## Outcome Variable: Support for radical change

### Model 1

Similarity score as predictor; conservatism as control.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(change_z ~ brokencontract_openai_z + ideo_con_z ,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

### Model 2

Similarity score as predictor; conservatism, SDO, and TIPI agreeableness as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(change_z ~ brokencontract_openai_z + ideo_con_z + SDO_z + TIPI_agree_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

### Model 3

Similarity score as predictor; conservatism, SDO, TIPI agreeableness, gender, race, ethnicity, income, education, and age as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(change_z ~ brokencontract_openai_z + ideo_con_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)

```

### Model 4

Similarity score as predictor; conservatism, SDO, TIPI agreeableness, gender, race, ethnicity, income, education, age, county mediation income, county GINI coefficient, and county density as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(change_z ~ brokencontract_openai_z + ideo_con_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z + county_medianincome_z + county_gini_z + county_density_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)

```

## Outcome Variable: Anti-establishment sentiment

### Model 1

Similarity score as predictor; conservatism as control.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(antiest_z ~ brokencontract_openai_z + ideo_con_z ,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

### Model 2

Similarity score as predictor; conservatism, SDO, and TIPI agreeableness as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(antiest_z ~ brokencontract_openai_z + ideo_con_z + SDO_z + TIPI_agree_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

### Model 3

Similarity score as predictor; conservatism, SDO, TIPI agreeableness, gender, race, ethnicity, income, education, and age as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(antiest_z ~ brokencontract_openai_z + ideo_con_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)

```

### Model 4

Similarity score as predictor; conservatism, SDO, TIPI agreeableness, gender, race, ethnicity, income, education, age, county mediation income, county GINI coefficient, and county density as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(antiest_z ~ brokencontract_openai_z + ideo_con_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z + county_medianincome_z + county_gini_z + county_density_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)

summary(m1)
```

## Outcome Variable: Trust in democratic institutions

### Model 1

Similarity score as predictor; conservatism as control.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(trust_deminst_z ~ brokencontract_openai_z + ideo_con_z ,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

### Model 2

Similarity score as predictor; conservatism, SDO, and TIPI agreeableness as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(trust_deminst_z ~ brokencontract_openai_z + ideo_con_z + SDO_z + TIPI_agree_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

### Model 3

Similarity score as predictor; conservatism, SDO, TIPI agreeableness, gender, race, ethnicity, income, education, and age as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(trust_deminst_z ~ brokencontract_openai_z + ideo_con_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)

```

### Model 4

Similarity score as predictor; conservatism, SDO, TIPI agreeableness, gender, race, ethnicity, income, education, age, county mediation income, county GINI coefficient, and county density as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(trust_deminst_z ~ brokencontract_openai_z + ideo_con_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z + county_medianincome_z + county_gini_z + county_density_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)

```

## Outcome Variable: Trust in national mainstream institutions

### Model 1

Similarity score as predictor; conservatism as control.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(trust_natinst_z ~ brokencontract_openai_z + ideo_con_z ,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

### Model 2

Similarity score as predictor; conservatism, SDO, and TIPI agreeableness as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(trust_natinst_z ~ brokencontract_openai_z + ideo_con_z + SDO_z + TIPI_agree_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

### Model 3

Similarity score as predictor; conservatism, SDO, TIPI agreeableness, gender, race, ethnicity, income, education, and age as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(trust_natinst_z ~ brokencontract_openai_z + ideo_con_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)

```

### Model 4

Similarity score as predictor; conservatism, SDO, TIPI agreeableness, gender, race, ethnicity, income, education, age, county mediation income, county GINI coefficient, and county density as controls.

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(trust_natinst_z ~ brokencontract_openai_z + ideo_con_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z + county_medianincome_z + county_gini_z + county_density_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```



# Interactions with political ideology

## Outcome variable: Support for radical change

### Conservatism

#### With controls\

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(change_z ~ simi_openai_z*ideo_con_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z + county_medianincome_z + county_gini_z + county_density_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)

summary(m1)
```

#### Without controls\

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(change_z ~ simi_openai_z*ideo_con_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)

summary(m1)
```

### Liberalism

#### With controls\

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(change_z ~ simi_openai_z*ideo_lib_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z + county_medianincome_z + county_gini_z + county_density_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

#### Without controls\

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(change_z ~ simi_openai_z*ideo_lib_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)

summary(m1)
```

### Democratic socialism

#### With controls\

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(change_z ~ simi_openai_z*ideo_demsoc_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z + county_medianincome_z + county_gini_z + county_density_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

#### Without controls\

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(change_z ~ simi_openai_z*ideo_demsoc_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)

summary(m1)
```

### Libertarianism

#### With controls\

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(change_z ~ simi_openai_z*ideo_lbrtn_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z + county_medianincome_z + county_gini_z + county_density_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

#### Without controls\

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(change_z ~ simi_openai_z*ideo_lbrtn_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

### Progressivism

#### With controls\

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(change_z ~ simi_openai_z*ideo_prog_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z + county_medianincome_z + county_gini_z + county_density_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

#### Without controls\

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(change_z ~ simi_openai_z*ideo_prog_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

## Outcome variable: Anti-establishment

### Conservatism

#### With controls\

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(antiest_z ~ simi_openai_z*ideo_con_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z + county_medianincome_z + county_gini_z + county_density_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

#### Without controls\

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(antiest_z ~ simi_openai_z*ideo_con_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

### Liberalism

#### With controls\

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(antiest_z ~ simi_openai_z*ideo_lib_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z + county_medianincome_z + county_gini_z + county_density_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

#### Without controls\

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(antiest_z ~ simi_openai_z*ideo_lib_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

### Democratic socialism

#### With controls\

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(antiest_z ~ simi_openai_z*ideo_demsoc_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z + county_medianincome_z + county_gini_z + county_density_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

#### Without controls\

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(antiest_z ~ simi_openai_z*ideo_demsoc_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

### Libertarianism

#### With controls\

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(antiest_z ~ simi_openai_z*ideo_lbrtn_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z + county_medianincome_z + county_gini_z + county_density_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

#### Without controls\

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(antiest_z ~ simi_openai_z*ideo_lbrtn_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

### Progressivism

#### With controls\

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(antiest_z ~ simi_openai_z*ideo_prog_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z + county_medianincome_z + county_gini_z + county_density_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

#### Without controls\

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(antiest_z ~ simi_openai_z*ideo_prog_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

## Outcome variable: Trust in democratic institutions

### Conservatism

#### With controls\

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(trust_deminst_z ~ simi_openai_z*ideo_con_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z + county_medianincome_z + county_gini_z + county_density_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

#### Without controls\

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(trust_deminst_z ~ simi_openai_z*ideo_con_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

### Liberalism

#### With controls\

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(trust_deminst_z ~ simi_openai_z*ideo_lib_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z + county_medianincome_z + county_gini_z + county_density_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

#### Without controls\

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(trust_deminst_z ~ simi_openai_z*ideo_lib_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

### Democratic socialism

#### With controls\

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(trust_deminst_z ~ simi_openai_z*ideo_demsoc_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z + county_medianincome_z + county_gini_z + county_density_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

#### Without controls\

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(trust_deminst_z ~ simi_openai_z*ideo_demsoc_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE,fig.dim=c(5,3)}
m1 <- lm(trust_deminst_z ~ simi_openai_z*ideo_demsoc_z,data = df_bsc_elg)

interact_plot(m1,
              pred = simi_openai_z,
              modx = ideo_demsoc_z,
              interval = T)
```

### Libertarianism

#### With controls\

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(trust_deminst_z ~ simi_openai_z*ideo_lbrtn_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z + county_medianincome_z + county_gini_z + county_density_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

#### Without controls\

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(trust_deminst_z ~ simi_openai_z*ideo_lbrtn_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

### Progressivism

#### With controls\

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(trust_deminst_z ~ simi_openai_z*ideo_prog_z + SDO_z + TIPI_agree_z + man + race + hispanic + income_num_z + edu_num_z + age_z + county_medianincome_z + county_gini_z + county_density_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

#### Without controls\

```{r,results='asis',echo=TRUE,warning=FALSE,message=FALSE}
m1 <- lm(trust_deminst_z ~ simi_openai_z*ideo_prog_z,data = df_bsc_elg)

apa_lm <- apa_print(m1)
apa_table(
  apa_lm$table, 
  placement = "H"
)
```

# Extra questions

## Values by ideology

```{r}
df_valuesbyideology <- df_bsc_long %>% 
  left_join(df_bsc_elg %>% 
              select(PID,brokencontract_openai,party_id,ideo_con:ideo_prog) %>% 
              mutate(is_elg = 1),by = "PID") %>% 
  filter(is_elg == 1) %>% 
  select(PID,brokencontract_openai,type,value,weight,party_id,ideo_con:ideo_prog) %>% 
  mutate(is_con = ifelse(ideo_con > 4,1,0),
         is_lib = ifelse(ideo_lib > 4,1,0),
         is_demsoc = ifelse(ideo_demsoc > 4,1,0),
         is_lbrtn = ifelse(ideo_lbrtn > 4,1,0),
         is_prog = ifelse(ideo_prog > 4,1,0))
```

### Conservatives 

```{r}
df_valuesbyideology %>% 
  filter(is_con == 1) %>% 
  select(type,weight,value) %>% 
  group_by(type,value) %>% 
  summarise(n = n()) %>% 
  ungroup() %>% 
  arrange(type,desc(n)) %>%  
  group_by(type) %>% 
  slice(1:10) %>% 
  kbl() %>% 
  kable_styling(bootstrap_options = "hover",
                position = "left") %>% 
  scroll_box(width = "100%", height = "400px")
```

### Liberals

```{r}
df_valuesbyideology %>% 
  filter(is_lib == 1) %>% 
  select(type,weight,value) %>% 
  group_by(type,value) %>% 
  summarise(n = n()) %>% 
  ungroup() %>% 
  arrange(type,desc(n)) %>%  
  group_by(type) %>% 
  slice(1:10) %>% 
  kbl() %>% 
  kable_styling(bootstrap_options = "hover",
                position = "left") %>% 
  scroll_box(width = "100%", height = "400px")
```

### Democratic socialists

```{r}
df_valuesbyideology %>% 
  filter(is_demsoc == 1) %>% 
  select(type,weight,value) %>% 
  group_by(type,value) %>% 
  summarise(n = n()) %>% 
  ungroup() %>% 
  arrange(type,desc(n)) %>%  
  group_by(type) %>% 
  slice(1:10) %>% 
  kbl() %>% 
  kable_styling(bootstrap_options = "hover",
                position = "left") %>% 
  scroll_box(width = "100%", height = "400px")
```

```{r}
df_bsc_elg %>% 
  group_by(party_id) %>% 
  summarise(mean = mean(brokencontract_openai,na.rm = T),
            sd = sd(brokencontract_openai,na.rm = T)) %>% 
  ungroup()
```

# by ideology

```{r}
df_bsc_elg %>% 
  select(brokencontract_openai,ideo_con:ideo_prog) %>% 
  pivot_longer(-brokencontract_openai,
               names_to = "ideo",
               values_to = "score",
               names_prefix = "ideo_",
               values_drop_na = T) %>% 
  ggplot(aes(x = score,y = brokencontract_openai)) +
  geom_smooth(method = "lm") +
  facet_wrap(~ideo)

df_bsc_elg %>% 
  select(brokencontract_openai,ideo_con:ideo_prog) %>% 
  corPlot(stars = T)
```

```{r}
df_bsc_elg %>% 
  lm(change ~ brokencontract_openai*party_id,data = .) %>% 
  summary()

df_bsc_elg %>% 
  ggplot(aes(x = brokencontract_openai,y = trust_deminst,colour = party_id)) +
  geom_smooth(method = "lm")
```

